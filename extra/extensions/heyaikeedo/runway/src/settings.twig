{% extends "/layouts/main.twig" %}
{% set active_menu = 'settings' %}

{% set xdata = 'settings' %}
{% block title p__('title', 'Runway API Settings') %}

{% block template %}
<div>
  {% include "snippets/back.twig" with {link: 'admin/settings', label: 'Settings'} %}

  <h1 class="mt-4">{{ p__('heading', 'Runway API') }}</h1>
  <p class="text-content-dimmed">
    {{ __('Configure your Runway API integration for advanced AI video and image generation. Get your API key from') }}
    <a href="https://docs.dev.runwayml.com/" target="_blank" class="text-content hover:underline">
      {{ __('Runway Developer Portal') }}
    </a>
  </p>
</div>

<x-form>
  <form class="flex flex-col gap-8" @submit.prevent="submit" x-ref="form">
    <div class="flex flex-col gap-2">
      <section class="flex flex-col gap-6 box" data-density="comfortable">
        <h2>{{ p__('heading', 'API Configuration') }}</h2>

        <div>
          <label for="runway.api_key">
            {{ p__('label', 'API Key') }}
          </label>

          <div class="relative mt-2" x-data="{isVisible: false}">
            <input class="input pr-11" id="runway.api_key"
              name="runway[api_key]"
              :type="isVisible ? 'text' : 'password'" autocomplete="off"
              placeholder="{{ __('Enter your Runway API key') }}"
              value="{{ environment == 'demo' ? 'hidden-in-demo' : option.runway.api_key ?? '' }}"
              required>

            <button type="button"
              class="absolute text-2xl -translate-y-1/2 top-1/2 right-3 text-content-dimmed"
              @click="isVisible = !isVisible">
              <i class="block ti"
                :class="{'ti-eye-closed' : isVisible, 'ti-eye': !isVisible}"></i>
            </button>
          </div>

          <ul class="m-3 mb-0 text-xs list-disc list-inside text-content-dimmed">
            <li>
              {{ __('Get your API key from the') }}
              <a href="https://docs.dev.runwayml.com/" target="_blank" class="text-content hover:underline">
                {{ p__('link', 'Runway Developer Portal') }}
              </a>
            </li>
            <li>{{ __('API key is required to use Runway AI models for image and video generation') }}</li>
            <li>{{ __('Your API key is stored securely and never shared') }}</li>
          </ul>
        </div>
      </section>

      <section class="flex flex-col gap-6 box" data-density="comfortable">
        <h2>{{ p__('heading', 'Available Models') }}</h2>
        
        <div class="grid gap-4 md:grid-cols-2">
          <div class="p-4 border rounded-lg border-line-dimmed">
            <h3 class="font-semibold">{{ __('Gen4 Image') }}</h3>
            <p class="text-sm text-content-dimmed">{{ __('Advanced image generation with reference image support and style transfer') }}</p>
            <div class="mt-2 text-xs text-accent">{{ __('Image Generation') }}</div>
          </div>

          <div class="p-4 border rounded-lg border-line-dimmed">
            <h3 class="font-semibold">{{ __('Gen4 Turbo') }}</h3>
            <p class="text-sm text-content-dimmed">{{ __('Fast video generation with good quality and speed balance') }}</p>
            <div class="mt-2 text-xs text-accent">{{ __('Video Generation') }}</div>
          </div>

          <div class="p-4 border rounded-lg border-line-dimmed">
            <h3 class="font-semibold">{{ __('Gen4 Aleph') }}</h3>
            <p class="text-sm text-content-dimmed">{{ __('Highest quality video generation model with advanced features') }}</p>
            <div class="mt-2 text-xs text-accent">{{ __('Video Generation') }}</div>
          </div>

          <div class="p-4 border rounded-lg border-line-dimmed opacity-60">
            <h3 class="font-semibold">{{ __('Act-Two') }}</h3>
            <p class="text-sm text-content-dimmed">{{ __('Face transfer model (Coming Soon)') }}</p>
            <div class="mt-2 text-xs text-content-dimmed">{{ __('Face Transfer') }}</div>
          </div>
        </div>

        <div class="p-4 rounded-lg bg-intermediate">
          <h4 class="font-medium">{{ __('Model Features') }}</h4>
          <ul class="mt-2 text-sm list-disc list-inside text-content-dimmed">
            <li>{{ __('Support for multiple aspect ratios (16:9, 9:16, 1:1, etc.)') }}</li>
            <li>{{ __('Reference image support for style transfer and image-to-video') }}</li>
            <li>{{ __('Configurable video duration (5-10 seconds)') }}</li>
            <li>{{ __('High-quality output with automatic optimization') }}</li>
            <li>{{ __('Async processing with real-time progress updates') }}</li>
          </ul>
        </div>
      </section>

      <section class="flex flex-col gap-6 box" data-density="comfortable">
        <h2>{{ p__('heading', 'Usage & Billing') }}</h2>
        
        <div class="p-4 rounded-lg bg-intermediate">
          <h4 class="font-medium">{{ __('Pricing Information') }}</h4>
          <ul class="mt-2 text-sm list-disc list-inside text-content-dimmed">
            <li>{{ __('Image generation: Charged per image generated') }}</li>
            <li>{{ __('Video generation: Charged per video generated') }}</li>
            <li>{{ __('Costs are deducted from your workspace credits') }}</li>
            <li>{{ __('Failed generations do not consume credits') }}</li>
          </ul>
        </div>

        <div class="p-4 border border-yellow-300 rounded-lg bg-yellow-50">
          <h4 class="font-medium text-yellow-800">{{ __('Important Notes') }}</h4>
          <ul class="mt-2 text-sm list-disc list-inside text-yellow-700">
            <li>{{ __('Runway API has usage limits and rate limiting') }}</li>
            <li>{{ __('Generation times vary based on complexity and server load') }}</li>
            <li>{{ __('Reference images are uploaded to secure CDN storage') }}</li>
            <li>{{ __('Generated content follows Runway\'s usage policies') }}</li>
          </ul>
        </div>
      </section>
    </div>

    <div class="flex justify-end gap-4">
      <a href="admin/settings" class="button button-outline">
        {{ p__('button', 'Cancel') }}
      </a>

      <button class="button button-accent" type="submit"
        :processing="isProcessing">
        {% include "/snippets/spinner.twig" %}
        {{ p__('button', 'Save Changes') }}
      </button>
    </div>
  </form>
</x-form>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Add any client-side functionality here if needed
  console.log('Runway API settings page loaded');
});
</script>
{% endblock %}
