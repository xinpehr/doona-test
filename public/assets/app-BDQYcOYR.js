import{m as y}from"./module.esm-uXcmRlT3.js";import{C as Bt,m as Ut}from"./formdata-CXhcTFCf.js";import{A as Nt,I as Ht}from"./ip-K9DB_9g-.js";import{g as Ae,t as w,_ as E}from"./toast-C5YoKCAA.js";import{g as Ot,m as At}from"./markdown-FJn6D3UB.js";import{h as Le}from"./redirect-DipYIrIg.js";function Wt(){y.store("user",window.state.user),y.store("workspace",window.state.workspace)}let f=new Nt;f.base="/api";function zt(){let a=[],n=!1;async function i(s=null){let e={};s&&(e.starting_after=s);let r=await(await f.get("/categories",e)).json();if(r.data.length==0){n=!0;return}return a.push(...r.data),n||i(a[a.length-1].id),a}return i()}function Re(){let a=[],n=!1;async function i(s=null){let e={sort:"price:asc"};s&&(e.starting_after=s);let r=await(await f.get("/billing/plans",e)).json();if(r.data.length==0){n=!0;return}return a.push(...r.data),n||i(a[a.length-1].id),a}return i()}function Kt(){y.data("lc",(a=[],n=[])=>({filters:a,sort:n,orderby:null,dir:null,params:{query:null,sort:null},init(){this.filters.forEach(s=>this.params[s.model]=null),this.getCategories(),this.getPlans(),["orderby","dir"].forEach(s=>{this.$watch(s,()=>{this.params.sort=null,this.orderby&&(this.params.sort=this.orderby,this.dir&&(this.params.sort+=`:${this.dir}`))})}),this.$watch("params",s=>{this.$dispatch("lc.filtered",s),this.updateUrl()}),this.parseUrl(),window.addEventListener("lc.reset",()=>this.resetFilters())},resetFilters(){for(const i in this.params)i!="sort"&&(this.params[i]=null)},getCategories(){let i=this.filters.find(s=>s.model=="category");i&&zt().then(s=>{s.forEach(e=>{i.options.push({value:e.id,label:e.title}),this.parseUrl()})})},getPlans(){let i=this.filters.find(e=>e.model=="plan");if(!i)return;let s=i.billing_cycle||[];Re().then(e=>{e.forEach(t=>{(s.length==0||s.includes(t.billing_cycle))&&i.options.push({value:t.id,label:t.title+" / "+Ae(t.billing_cycle)})}),this.parseUrl()})},parseUrl(){var e;let i=new URL(window.location.href),s=new URLSearchParams(i.search.slice(1));for(const t in this.params){if(!s.has(t))continue;if(t=="query"){this.params.query=s.get(t);continue}let r=this.filters.find(l=>l.model==t);!r||!((e=r.options)!=null&&e.find(l=>l.value==s.get(t)))&&!r.hidden||(this.params[t]=s.get(t))}if(this.params.sort){let t=this.params.sort.split(":");this.orderby=t[0],this.dir=t[1]||"asc"}},updateUrl(){let i=new URL(window.location.href),s=new URLSearchParams(i.search.slice(1));for(const e in this.params)this.params[e]?s.set(e,this.params[e]):s.delete(e);window.history.pushState({},"",`${i.origin}${i.pathname}?${s}`)}})),y.data("list",(a,n=[],i=25,s=!0)=>({state:"initial",params:{},total:null,all:null,cursor:null,resources:[],isLoading:!1,hasMore:!0,isFiltered:!1,currentResource:null,isDeleting:!1,init(){this.loadMore(),s&&this.getTotalCount();let e=null;e=setTimeout(()=>this.retrieveResources(),200),window.addEventListener("lc.filtered",t=>{clearTimeout(e),e=setTimeout(()=>{this.params=t.detail,this.retrieveResources(!0)},200)})},applyQueryParams(e){let t=new URL(window.location.href);new URLSearchParams(t.search.slice(1)).forEach((o,l)=>{e[l]=o})},getTotalCount(){let e={};this.applyQueryParams(e),f.get(`${a}/count`,e).then(t=>t.json()).then(t=>this.total=t.count),e.hasOwnProperty("all")||(e.all=!0,f.get(`${a}/count`,e).then(t=>t.json()).then(t=>this.all=t.count))},retrieveResources(e=!1){this.isLoading=!0;let t={limit:i},r=!1;e||this.applyQueryParams(t);for(const o in this.params)this.params[o]&&(o!="sort"&&(r=!0),t[o]=this.params[o]);this.isFiltered=r,!e&&this.cursor&&(t.starting_after=this.cursor),f.get(a,t).then(o=>o.json()).then(o=>{this.state="loaded",this.resources=e?o.data:this.resources.concat(o.data),this.resources.length>0?this.cursor=this.resources[this.resources.length-1].id:this.state="empty",this.isLoading=!1,this.hasMore=o.data.length>=i})},loadMore(){const e=document.getElementById("content");e.addEventListener("scroll",()=>{this.hasMore&&!this.isLoading&&e.clientHeight+e.scrollTop+500>=e.scrollHeight&&this.retrieveResources()})},toggleStatus(e){e.status=e.status==1?0:1,f.post(`${a}/${e.id}`,{status:e.status})},deleteResource(e){this.isDeleting=!0,f.delete(`${a}/${e.id}`).then(()=>{this.resources.splice(this.resources.indexOf(e),1),window.modal.close(),this.currentResource=null,w.show(n.delete_success,"ti ti-trash"),this.isDeleting=!1}).catch(t=>{this.isDeleting=!1})},getBillingCycleLabel(e){return Ae(e)}})),y.data("masonry",()=>({set:[],columnCount:2,init(){this.updateColumnCount(),this.distributeItems(),new ResizeObserver(n=>{this.updateColumnCount()}).observe(this.$el),this.$watch("resources",()=>{this.distributeItems()})},updateColumnCount(){const a=this.$el,n=window.getComputedStyle(a);let i;n.display==="grid"?i=n.gridTemplateColumns.split(" ").length:i=parseInt(n.columnCount)||parseInt(n.columns)||parseInt(n.WebkitColumnCount)||parseInt(n.MozColumnCount),i=i||2,this.columnCount!==i&&(this.columnCount=i,this.distributeItems())},distributeItems(){var n;const a=Array.from({length:this.columnCount},(i,s)=>({id:`column-${s}`,items:[],height:0}));(n=this.resources)!=null&&n.length&&this.resources.forEach(i=>{var t,r;let s=1;i.output_file&&((t=i.output_file)!=null&&t.height)&&((r=i.output_file)!=null&&r.width)&&(s=i.output_file.height/i.output_file.width);let e=a[0];for(const o of a)o.height<e.height&&(e=o);e.items.push(i),e.height+=s}),this.set=a.map(({id:i,items:s})=>({id:i,items:s}))}}))}function Yt(){y.data("billing",()=>({orders:[],init(){this.getOrders()},cancelSubscription(){f.delete("/billing/subscription").then(()=>{w.success("Subscription cancelled!"),window.modal.close(),window.location.reload()})},getOrders(){f.get("/billing/orders",{sort:"created_at:desc",limit:3}).then(a=>a.json()).then(a=>this.orders=a.data)}})),y.data("plans",()=>({state:"initial",plans:{monthly:[],yearly:[],lifetime:[]},freePlan:null,cycle:null,showSwitch:!1,init(){Re().then(a=>{if(!a){this.state="empty";return}let n=a.filter(i=>i.price===0&&["monthly","yearly"].includes(i.billing_cycle));n.length==1&&(this.freePlan=n[0]),["monthly","yearly","lifetime"].forEach(i=>{this.plans[i]=a.filter(s=>s.billing_cycle===i&&(!this.freePlan||s.id!==this.freePlan.id))}),this.plans.monthly.length>0?this.cycle="monthly":this.plans.yearly.length>0?this.cycle="yearly":this.plans.lifetime.length>0&&(this.cycle="lifetime"),this.$store.workspace.is_eligible_for_free_plan||(this.freePlan=null),this.state=this.freePlan||this.plans.monthly.length>0||this.plans.yearly.length>0||this.plans.lifetime.length>0?"normal":"empty",this.showSwitch=Object.values(this.plans).map(i=>i.length).filter(i=>i>0).length>=2})}})),y.data("packs",()=>({state:"initial",packs:[],init(){Re().then(a=>{if(!a){this.state="empty";return}this.packs=a.filter(n=>n.billing_cycle==="one-time"),this.state=this.packs.length>0?"normal":"empty"})}}))}var b={},ae,Me;function Gt(){return Me||(Me=1,ae=function(n){return n=n||window.navigator.userAgent,/Android/i.test(n)}),ae}var oe,Ve;function Xt(){return Ve||(Ve=1,oe=Gt()),oe}var le,qe;function Jt(){return qe||(qe=1,le=function(n){return n=n||window.navigator.userAgent,/CrOS/i.test(n)}),le}var he,Fe;function Qt(){return Fe||(Fe=1,he=Jt()),he}var ce,je;function Zt(){return je||(je=1,ce=function(n){return n=n||window.navigator.userAgent,n.indexOf("Edge/")!==-1||n.indexOf("Edg/")!==-1}),ce}var ue,Be;function ei(){return Be||(Be=1,ue=function(n){return n=n||window.navigator.userAgent,/SamsungBrowser/i.test(n)}),ue}var de,Ue;function ti(){return Ue||(Ue=1,de=function(n){return n=n||window.navigator.userAgent,n.indexOf("DuckDuckGo/")!==-1}),de}var fe,Ne;function ii(){return Ne||(Ne=1,fe=function(n){return n=n||window.navigator.userAgent,n.indexOf("OPR/")!==-1||n.indexOf("Opera/")!==-1||n.indexOf("OPT/")!==-1}),fe}var pe,He;function si(){return He||(He=1,pe=function(n){return n=n||window.navigator.userAgent,n.indexOf("Silk/")!==-1}),pe}var me,We;function ri(){if(We)return me;We=1;var a=Zt(),n=ei(),i=ti(),s=ii(),e=si();return me=function(r){return r=r||window.navigator.userAgent,(r.indexOf("Chrome")!==-1||r.indexOf("CriOS")!==-1)&&!a(r)&&!n(r)&&!i(r)&&!s(r)&&!e(r)},me}var ge,ze;function ni(){return ze||(ze=1,ge=ri()),ge}var ve,Ke;function ai(){return Ke||(Ke=1,ve=function(n,i){return n=n||window.navigator.userAgent,i=i||window.document,/Mac|iPad/i.test(n)&&"ontouchend"in i}),ve}var ye,Ye;function oi(){if(Ye)return ye;Ye=1;var a=ai();return ye=function(i,s,e){s===void 0&&(s=!0),i=i||window.navigator.userAgent;var t=/iPhone|iPod|iPad/i.test(i);return s?t||a(i,e):t},ye}var we,Ge;function li(){return Ge||(Ge=1,we=oi()),we}var _e,Xe;function hi(){return Xe||(Xe=1,_e=function(n){return n=n||window.navigator.userAgent,n.indexOf("MSIE 9")!==-1}),_e}var be,Je;function ci(){return Je||(Je=1,be=hi()),be}var Qe;function Lt(){if(Qe)return b;Qe=1,Object.defineProperty(b,"__esModule",{value:!0}),b.isIos=b.isIE9=b.isSamsungBrowser=b.isAndroidChrome=b.isKitKatWebview=void 0;var a=typeof window<"u"&&window.navigator&&window.navigator.userAgent,n=Xt(),i=Qt(),s=ni(),e=li();b.isIos=e;var t=ci();b.isIE9=t;var r=/Version\/\d\.\d* Chrome\/\d*\.0\.0\.0/;function o(c){return!s(c)&&c.indexOf("Samsung")>-1}function l(c){return c===void 0&&(c=a),n(c)&&r.test(c)}b.isKitKatWebview=l;function h(c){return c===void 0&&(c=a),(n(c)||i(c))&&s(c)}b.isAndroidChrome=h;function u(c){return c===void 0&&(c=a),/SamsungBrowser/.test(c)||o(c)}return b.isSamsungBrowser=u,b}var Pe,Ze;function ui(){if(Ze)return Pe;Ze=1;var a=Lt();return Pe=function(){return!(0,a.isSamsungBrowser)()},Pe}var C={},R={},A={},et;function di(){if(et)return A;et=1,Object.defineProperty(A,"__esModule",{value:!0}),A.StrategyInterface=void 0;var a=function(){function n(i){this.inputElement=i.element,this.isFormatted=!1}return n}();return A.StrategyInterface=a,A}var L={},$={},tt;function ee(){if(tt)return $;tt=1,Object.defineProperty($,"__esModule",{value:!0}),$.set=$.get=void 0;function a(i){var s=i.selectionStart||0,e=i.selectionEnd||0;return{start:s,end:e,delta:Math.abs(e-s)}}$.get=a;function n(i,s,e){document.activeElement===i&&i.setSelectionRange&&i.setSelectionRange(s,e)}return $.set=n,$}var it;function ie(){if(it)return L;it=1,Object.defineProperty(L,"__esModule",{value:!0}),L.keyCannotMutateValue=void 0;var a=ee();function n(i){var s=i.currentTarget||i.srcElement,e=(0,a.get)(s),t=e.start===0,r=e.start===s.value.length,o=i.shiftKey===!0;switch(i.key){case void 0:case"Unidentified":case"":break;case"Backspace":return t;case"Del":case"Delete":return r;default:return i.key.length!==1}switch(i.keyCode){case 9:case 19:case 20:case 27:case 39:case 45:return!0;case 33:case 34:case 35:case 36:case 37:case 38:case 40:return!o;case 8:return t;case 46:return r;default:return!1}}return L.keyCannotMutateValue=n,L}var M={},st;function Mt(){if(st)return M;st=1,Object.defineProperty(M,"__esModule",{value:!0}),M.isBackspace=void 0;function a(n){return n.key==="Backspace"||n.keyCode===8}return M.isBackspace=a,M}var V={},rt;function fi(){if(rt)return V;rt=1,Object.defineProperty(V,"__esModule",{value:!0}),V.isDelete=void 0;var a=/^Del(ete)?$/;function n(i){return a.test(i.key)||i.keyCode===46}return V.isDelete=n,V}var q={},F={},nt;function pi(){if(nt)return F;nt=1,Object.defineProperty(F,"__esModule",{value:!0}),F.parsePattern=void 0;var a=/[A-Za-z]/,n=/\d/,i=/./,s=/^[A-Za-z0-9\*]$/,e="({{[^}]+}})",t="(\\s|\\S)",r=new RegExp(e+"|"+t,"g"),o=new RegExp("^"+e+"$"),l=new RegExp("{|}","g");function h(p){return n.test(p)}function u(p){return a.test(p)}function c(p){return h(p)?n:u(p)?a:i}function d(p){return s.test(p)}function g(p){return o.test(p)}function m(p){var v=[],_=p.match(r);if(!_)return v;for(var P=0,I=0;I<_.length;I++){var re=_[I];if(g(re))for(var Te=re.replace(l,"").split(""),ne=0;ne<Te.length;ne++){var Oe=Te[ne];if(!d(Oe))throw new Error("Only alphanumeric or wildcard pattern matchers are allowed");v.push({value:c(Oe),isPermaChar:!1,index:P++})}else v.push({value:re,isPermaChar:!0,index:P++})}return v}return F.parsePattern=m,F}var at;function mi(){if(at)return q;at=1,Object.defineProperty(q,"__esModule",{value:!0}),q.PatternFormatter=void 0;var a=pi(),n=Mt(),i=function(){function s(e){this.pattern=(0,a.parsePattern)(e)}return s.prototype.format=function(e){for(var t=e.value,r=0,o="",l={start:e.selection.start,end:e.selection.end},h=0;h<this.pattern.length;h++){var u=this.pattern[h],c=t[r];if(r>t.length)break;if(typeof u.value=="string")(c!=null||o.length===u.index)&&(o+=u.value,u.index<=l.start&&l.start++,u.index<=l.end&&l.end++);else for(;r<t.length;r++)if(c=t[r],u.value.test(c)){o+=c,r++;break}else u.index<=l.start&&l.start--,u.index<=l.end&&l.end--}return{value:o,selection:l}},s.prototype.unformat=function(e){for(var t=e.selection.start,r=e.selection.end,o="",l=0;l<this.pattern.length;l++){var h=this.pattern[l];if(typeof h.value!="string"&&e.value[l]!=null&&h.value.test(e.value[l])){o+=e.value[l];continue}h.value===e.value[h.index]&&(h.index<e.selection.start&&t--,h.index<e.selection.end&&r--)}return{selection:{start:t,end:r},value:o}},s.prototype.simulateDeletion=function(e){var t,r,o=this.unformat(e),l=o.value,h=o.selection,u=Math.abs(o.selection.end-o.selection.start);return u?(t=h.start,r=h.end):(0,n.isBackspace)(e.event)?(t=Math.max(0,h.start-1),r=h.start):(t=h.start,r=Math.min(l.length,h.start+1)),{selection:{start:t,end:t},value:l.substr(0,t)+l.substr(r)}},s}();return q.PatternFormatter=i,q}var ot;function se(){if(ot)return R;ot=1;var a=R&&R.__extends||function(){var h=function(u,c){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,g){d.__proto__=g}||function(d,g){for(var m in g)Object.prototype.hasOwnProperty.call(g,m)&&(d[m]=g[m])},h(u,c)};return function(u,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");h(u,c);function d(){this.constructor=u}u.prototype=c===null?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(R,"__esModule",{value:!0}),R.BaseStrategy=void 0;var n=di(),i=ie(),s=ee(),e=Mt(),t=fi(),r=mi();function o(h){return!h.key&&!h.keyCode}var l=function(h){a(u,h);function u(c){var d=h.call(this,c)||this;return d.hasKeypressEvent=!1,d.formatter=new r.PatternFormatter(c.pattern),d.onPasteEvent=c.onPasteEvent,d.attachListeners(),d.formatIfNotEmpty(),d}return u.prototype.getUnformattedValue=function(c){var d=this.inputElement.value;return(c||this.isFormatted)&&(d=this.formatter.unformat({value:this.inputElement.value,selection:{start:0,end:0}}).value),d},u.prototype.formatIfNotEmpty=function(){this.inputElement.value&&this.reformatInput()},u.prototype.setPattern=function(c){this.unformatInput(),this.formatter=new r.PatternFormatter(c),this.formatIfNotEmpty()},u.prototype.attachListeners=function(){var c=this;this.inputElement.addEventListener("keydown",function(d){var g=d;o(g)&&(c.isFormatted=!1),!(0,i.keyCannotMutateValue)(g)&&c.isDeletion(g)&&c.unformatInput()}),this.inputElement.addEventListener("keypress",function(d){c.hasKeypressEvent=!0,c.onKeypress(d)}),this.inputElement.addEventListener("keyup",function(){c.reformatInput(),c.hasKeypressEvent=!1}),this.inputElement.addEventListener("input",function(d){var g=d;c.hasKeypressEvent||c.onKeypress(d),(g instanceof CustomEvent||!g.isTrusted)&&(c.isFormatted=!1),c.reformatInput()}),this.inputElement.addEventListener("paste",function(d){c.pasteEventHandler(d)})},u.prototype.isDeletion=function(c){return(0,t.isDelete)(c)||(0,e.isBackspace)(c)},u.prototype.reformatInput=function(){if(!this.isFormatted){this.isFormatted=!0;var c=this.inputElement,d=this.formatter.format({selection:(0,s.get)(c),value:c.value});c.value=d.value,(0,s.set)(c,d.selection.start,d.selection.end),this.afterReformatInput(d)}},u.prototype.afterReformatInput=function(c){},u.prototype.unformatInput=function(){if(this.isFormatted){this.isFormatted=!1;var c=this.inputElement,d=(0,s.get)(c),g=this.formatter.unformat({selection:d,value:c.value});c.value=g.value,(0,s.set)(c,g.selection.start,g.selection.end)}},u.prototype.prePasteEventHandler=function(c){c.preventDefault()},u.prototype.postPasteEventHandler=function(){this.reformatAfterPaste()},u.prototype.pasteEventHandler=function(c){var d,g="";this.prePasteEventHandler(c),this.unformatInput(),c.clipboardData?g=c.clipboardData.getData("Text"):window.clipboardData&&(g=window.clipboardData.getData("Text"));var m=(0,s.get)(this.inputElement);d=this.inputElement.value.split(""),d.splice(m.start,m.end-m.start,g),d=d.join(""),this.onPasteEvent&&this.onPasteEvent({unformattedInputValue:d}),this.inputElement.value=d,(0,s.set)(this.inputElement,m.start+g.length,m.start+g.length),this.postPasteEventHandler()},u.prototype.reformatAfterPaste=function(){var c=document.createEvent("Event");this.reformatInput(),c.initEvent("input",!0,!0),this.inputElement.dispatchEvent(c)},u.prototype.getStateToFormat=function(){var c=this.inputElement,d=(0,s.get)(c),g={selection:d,value:c.value};return this.stateToFormat?(g=this.stateToFormat,delete this.stateToFormat):d.start===c.value.length&&this.isFormatted&&(g=this.formatter.unformat(g)),g},u.prototype.onKeypress=function(c){o(c)&&(this.isFormatted=!1),!(0,i.keyCannotMutateValue)(c)&&this.unformatInput()},u}(n.StrategyInterface);return R.BaseStrategy=l,R}var lt;function gi(){if(lt)return C;lt=1;var a=C&&C.__extends||function(){var t=function(r,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,h){l.__proto__=h}||function(l,h){for(var u in h)Object.prototype.hasOwnProperty.call(h,u)&&(l[u]=h[u])},t(r,o)};return function(r,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");t(r,o);function l(){this.constructor=r}r.prototype=o===null?Object.create(o):(l.prototype=o.prototype,new l)}}();Object.defineProperty(C,"__esModule",{value:!0}),C.IosStrategy=void 0;var n=se(),i=ie(),s=ee(),e=function(t){a(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.getUnformattedValue=function(){return t.prototype.getUnformattedValue.call(this,!0)},r.prototype.attachListeners=function(){var o=this;this.inputElement.addEventListener("keydown",function(l){o.keydownListener(l)}),this.inputElement.addEventListener("input",function(l){var h=l instanceof CustomEvent;h&&(o.stateToFormat={selection:{start:0,end:0},value:o.inputElement.value}),o.formatListener(),h||o.fixLeadingBlankSpaceOnIos()}),this.inputElement.addEventListener("paste",function(l){o.pasteEventHandler(l)})},r.prototype.fixLeadingBlankSpaceOnIos=function(){var o=this.inputElement;o.value===""&&setTimeout(function(){o.value=""},0)},r.prototype.formatListener=function(){var o=this.inputElement,l=this.getStateToFormat(),h=this.formatter.format(l);o.value=h.value,(0,s.set)(o,h.selection.start,h.selection.end)},r.prototype.keydownListener=function(o){(0,i.keyCannotMutateValue)(o)||this.isDeletion(o)&&(this.stateToFormat=this.formatter.simulateDeletion({event:o,selection:(0,s.get)(this.inputElement),value:this.inputElement.value}))},r}(n.BaseStrategy);return C.IosStrategy=e,C}var k={},ht;function Vt(){if(ht)return k;ht=1;var a=k&&k.__extends||function(){var t=function(r,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,h){l.__proto__=h}||function(l,h){for(var u in h)Object.prototype.hasOwnProperty.call(h,u)&&(l[u]=h[u])},t(r,o)};return function(r,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");t(r,o);function l(){this.constructor=r}r.prototype=o===null?Object.create(o):(l.prototype=o.prototype,new l)}}();Object.defineProperty(k,"__esModule",{value:!0}),k.AndroidChromeStrategy=void 0;var n=ie(),i=se(),s=ee(),e=function(t){a(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.attachListeners=function(){var o=this;this.inputElement.addEventListener("keydown",function(l){(0,n.keyCannotMutateValue)(l)||o.unformatInput()}),this.inputElement.addEventListener("keyup",function(){o.reformatInput()}),this.inputElement.addEventListener("input",function(){o.reformatInput()}),this.inputElement.addEventListener("paste",function(l){l.preventDefault(),o.pasteEventHandler(l)})},r.prototype.prePasteEventHandler=function(){},r.prototype.postPasteEventHandler=function(){var o=this;setTimeout(function(){o.reformatAfterPaste()},0)},r.prototype.afterReformatInput=function(o){var l=this.inputElement;setTimeout(function(){var h=o.selection;(0,s.set)(l,h.end,h.end)},0)},r}(i.BaseStrategy);return k.AndroidChromeStrategy=e,k}var D={},ct;function vi(){if(ct)return D;ct=1;var a=D&&D.__extends||function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},s(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");s(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(D,"__esModule",{value:!0}),D.KitKatChromiumBasedWebViewStrategy=void 0;var n=Vt(),i=function(s){a(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.prototype.reformatInput=function(){var t=this;setTimeout(function(){s.prototype.reformatInput.call(t)},0)},e.prototype.unformatInput=function(){var t=this;setTimeout(function(){s.prototype.unformatInput.call(t)},0)},e}(n.AndroidChromeStrategy);return D.KitKatChromiumBasedWebViewStrategy=i,D}var T={},ut;function yi(){if(ut)return T;ut=1;var a=T&&T.__extends||function(){var r=function(o,l){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,u){h.__proto__=u}||function(h,u){for(var c in u)Object.prototype.hasOwnProperty.call(u,c)&&(h[c]=u[c])},r(o,l)};return function(o,l){if(typeof l!="function"&&l!==null)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");r(o,l);function h(){this.constructor=o}o.prototype=l===null?Object.create(l):(h.prototype=l.prototype,new h)}}();Object.defineProperty(T,"__esModule",{value:!0}),T.IE9Strategy=void 0;var n=se(),i=ie(),s=ee();function e(r,o){return{start:r.start+o,end:r.end+o}}var t=function(r){a(o,r);function o(){return r!==null&&r.apply(this,arguments)||this}return o.prototype.getUnformattedValue=function(){return n.BaseStrategy.prototype.getUnformattedValue.call(this,!0)},o.prototype.attachListeners=function(){var l=this;this.inputElement.addEventListener("keydown",function(h){l.keydownListener(h)}),this.inputElement.addEventListener("focus",function(){l.format()}),this.inputElement.addEventListener("paste",function(h){l.pasteEventHandler(h)})},o.prototype.format=function(){var l=this.inputElement,h=this.getStateToFormat(),u=this.formatter.format(h);l.value=u.value,(0,s.set)(l,u.selection.start,u.selection.end)},o.prototype.keydownListener=function(l){if(!(0,i.keyCannotMutateValue)(l)){if(l.preventDefault(),this.isDeletion(l))this.stateToFormat=this.formatter.simulateDeletion({event:l,selection:(0,s.get)(this.inputElement),value:this.inputElement.value});else{var h=this.inputElement.value,u=(0,s.get)(this.inputElement),c=h.slice(0,u.start)+l.key+h.slice(u.start);u=e(u,1),this.stateToFormat={selection:u,value:c},u.start===c.length&&(this.stateToFormat=this.formatter.unformat(this.stateToFormat))}this.format()}},o.prototype.reformatAfterPaste=function(){var l=this.inputElement,h=(0,s.get)(this.inputElement),u=this.formatter.format({selection:h,value:l.value}).value;h=e(h,1),l.value=u,setTimeout(function(){(0,s.set)(l,h.start,h.end)},0)},o}(n.BaseStrategy);return T.IE9Strategy=t,T}var Ee,dt;function wi(){if(dt)return Ee;dt=1;var a=Lt(),n=ui(),i=gi(),s=Vt(),e=vi(),t=yi(),r=se(),o=function(){function l(h){(0,a.isIos)()?this.strategy=new i.IosStrategy(h):(0,a.isKitKatWebview)()?this.strategy=new e.KitKatChromiumBasedWebViewStrategy(h):(0,a.isAndroidChrome)()?this.strategy=new s.AndroidChromeStrategy(h):(0,a.isIE9)()?this.strategy=new t.IE9Strategy(h):this.strategy=new r.BaseStrategy(h)}return l.prototype.getUnformattedValue=function(){return this.strategy.getUnformattedValue()},l.prototype.setPattern=function(h){this.strategy.setPattern(h)},l.supportsFormatting=function(){return n()},l}();return Ee=o,Ee}var xe,ft;function _i(){if(ft)return xe;ft=1;var a=wi();return xe=a,xe}var bi=_i();const Pi=Ot(bi);var Se,pt;function Ei(){if(pt)return Se;pt=1;var a={visa:{niceType:"Visa",type:"visa",patterns:[4],gaps:[4,8,12],lengths:[16,18,19],code:{name:"CVV",size:3}},mastercard:{niceType:"Mastercard",type:"mastercard",patterns:[[51,55],[2221,2229],[223,229],[23,26],[270,271],2720],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},"american-express":{niceType:"American Express",type:"american-express",patterns:[34,37],gaps:[4,10],lengths:[15],code:{name:"CID",size:4}},"diners-club":{niceType:"Diners Club",type:"diners-club",patterns:[[300,305],36,38,39],gaps:[4,10],lengths:[14,16,19],code:{name:"CVV",size:3}},discover:{niceType:"Discover",type:"discover",patterns:[6011,[644,649],65],gaps:[4,8,12],lengths:[16,19],code:{name:"CID",size:3}},jcb:{niceType:"JCB",type:"jcb",patterns:[2131,1800,[3528,3589]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVV",size:3}},unionpay:{niceType:"UnionPay",type:"unionpay",patterns:[620,[62100,62182],[62184,62187],[62185,62197],[62200,62205],[622010,622999],622018,[62207,62209],[623,626],6270,6272,6276,[627700,627779],[627781,627799],[6282,6289],6291,6292,810,[8110,8131],[8132,8151],[8152,8163],[8164,8171]],gaps:[4,8,12],lengths:[14,15,16,17,18,19],code:{name:"CVN",size:3}},maestro:{niceType:"Maestro",type:"maestro",patterns:[493698,[5e5,504174],[504176,506698],[506779,508999],[56,59],63,67,6],gaps:[4,8,12],lengths:[12,13,14,15,16,17,18,19],code:{name:"CVC",size:3}},elo:{niceType:"Elo",type:"elo",patterns:[401178,401179,438935,457631,457632,431274,451416,457393,504175,[506699,506778],[509e3,509999],627780,636297,636368,[650031,650033],[650035,650051],[650405,650439],[650485,650538],[650541,650598],[650700,650718],[650720,650727],[650901,650978],[651652,651679],[655e3,655019],[655021,655058]],gaps:[4,8,12],lengths:[16],code:{name:"CVE",size:3}},mir:{niceType:"Mir",type:"mir",patterns:[[2200,2204]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVP2",size:3}},hiper:{niceType:"Hiper",type:"hiper",patterns:[637095,63737423,63743358,637568,637599,637609,637612],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},hipercard:{niceType:"Hipercard",type:"hipercard",patterns:[606282],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}}};return Se=a,Se}var j={},B={},mt;function qt(){if(mt)return B;mt=1,Object.defineProperty(B,"__esModule",{value:!0}),B.clone=void 0;function a(n){return n?JSON.parse(JSON.stringify(n)):null}return B.clone=a,B}var U={},gt;function xi(){if(gt)return U;gt=1,Object.defineProperty(U,"__esModule",{value:!0}),U.matches=void 0;function a(s,e,t){var r=String(e).length,o=s.substr(0,r),l=parseInt(o,10);return e=parseInt(String(e).substr(0,o.length),10),t=parseInt(String(t).substr(0,o.length),10),l>=e&&l<=t}function n(s,e){return e=String(e),e.substring(0,s.length)===s.substring(0,e.length)}function i(s,e){return Array.isArray(e)?a(s,e[0],e[1]):n(s,e)}return U.matches=i,U}var vt;function Si(){if(vt)return j;vt=1,Object.defineProperty(j,"__esModule",{value:!0}),j.addMatchingCardsToResults=void 0;var a=qt(),n=xi();function i(s,e,t){var r,o;for(r=0;r<e.patterns.length;r++){var l=e.patterns[r];if((0,n.matches)(s,l)){var h=(0,a.clone)(e);Array.isArray(l)?o=String(l[0]).length:o=String(l).length,s.length>=o&&(h.matchStrength=o),t.push(h);break}}}return j.addMatchingCardsToResults=i,j}var N={},yt;function Ii(){if(yt)return N;yt=1,Object.defineProperty(N,"__esModule",{value:!0}),N.isValidInputType=void 0;function a(n){return typeof n=="string"||n instanceof String}return N.isValidInputType=a,N}var H={},wt;function Ci(){if(wt)return H;wt=1,Object.defineProperty(H,"__esModule",{value:!0}),H.findBestMatch=void 0;function a(i){var s=i.filter(function(e){return e.matchStrength}).length;return s>0&&s===i.length}function n(i){return a(i)?i.reduce(function(s,e){return!s||Number(s.matchStrength)<Number(e.matchStrength)?e:s}):null}return H.findBestMatch=n,H}var W,_t;function Ft(){if(_t)return W;_t=1;var a=W&&W.__assign||function(){return a=Object.assign||function(m){for(var p,v=1,_=arguments.length;v<_;v++){p=arguments[v];for(var P in p)Object.prototype.hasOwnProperty.call(p,P)&&(m[P]=p[P])}return m},a.apply(this,arguments)},n=Ei(),i=Si(),s=Ii(),e=Ci(),t=qt(),r={},o={VISA:"visa",MASTERCARD:"mastercard",AMERICAN_EXPRESS:"american-express",DINERS_CLUB:"diners-club",DISCOVER:"discover",JCB:"jcb",UNIONPAY:"unionpay",MAESTRO:"maestro",ELO:"elo",MIR:"mir",HIPER:"hiper",HIPERCARD:"hipercard"},l=[o.VISA,o.MASTERCARD,o.AMERICAN_EXPRESS,o.DINERS_CLUB,o.DISCOVER,o.JCB,o.UNIONPAY,o.MAESTRO,o.ELO,o.MIR,o.HIPER,o.HIPERCARD],h=(0,t.clone)(l);function u(m){return r[m]||n[m]}function c(){return h.map(function(m){return(0,t.clone)(u(m))})}function d(m,p){p===void 0&&(p=!1);var v=h.indexOf(m);if(!p&&v===-1)throw new Error('"'+m+'" is not a supported card type.');return v}function g(m){var p=[];if(!(0,s.isValidInputType)(m))return p;if(m.length===0)return c();h.forEach(function(_){var P=u(_);(0,i.addMatchingCardsToResults)(m,P,p)});var v=(0,e.findBestMatch)(p);return v?[v]:p}return g.getTypeInfo=function(m){return(0,t.clone)(u(m))},g.removeCard=function(m){var p=d(m);h.splice(p,1)},g.addCard=function(m){var p=d(m.type,!0);r[m.type]=m,p===-1&&h.push(m.type)},g.updateCard=function(m,p){var v=r[m]||n[m];if(!v)throw new Error('"'.concat(m,"\" is not a recognized type. Use `addCard` instead.'"));if(p.type&&v.type!==p.type)throw new Error("Cannot overwrite type parameter.");var _=(0,t.clone)(v);_=a(a({},_),p),r[_.type]=_},g.changeOrder=function(m,p){var v=d(m);h.splice(v,1),h.splice(p,0,m)},g.resetModifications=function(){h=(0,t.clone)(l),r={}},g.types=o,W=g,W}var z={},bt;function Ri(){if(bt)return z;bt=1,Object.defineProperty(z,"__esModule",{value:!0}),z.cardholderName=void 0;var a=/^[\d\s-]*$/,n=255;function i(e,t){return{isValid:e,isPotentiallyValid:t}}function s(e){return typeof e!="string"?i(!1,!1):e.length===0?i(!1,!0):e.length>n?i(!1,!1):a.test(e)?i(!1,!0):i(!0,!0)}return z.cardholderName=s,z}var K={},Ie,Pt;function $i(){if(Pt)return Ie;Pt=1;function a(n){for(var i=0,s=!1,e=n.length-1,t;e>=0;)t=parseInt(n.charAt(e),10),s&&(t*=2,t>9&&(t=t%10+1)),s=!s,i+=t,e--;return i%10===0}return Ie=a,Ie}var Et;function ki(){if(Et)return K;Et=1,Object.defineProperty(K,"__esModule",{value:!0}),K.cardNumber=void 0;var a=$i(),n=Ft();function i(e,t,r){return{card:e,isPotentiallyValid:t,isValid:r}}function s(e,t){t===void 0&&(t={});var r,o,l;if(typeof e!="string"&&typeof e!="number")return i(null,!1,!1);var h=String(e).replace(/-|\s/g,"");if(!/^\d*$/.test(h))return i(null,!1,!1);var u=n(h);if(u.length===0)return i(null,!1,!1);if(u.length!==1)return i(null,!0,!1);var c=u[0];if(t.maxLength&&h.length>t.maxLength)return i(c,!1,!1);t.skipLuhnValidation===!0||c.type===n.types.UNIONPAY&&t.luhnValidateUnionPay!==!0?o=!0:o=a(h),l=Math.max.apply(null,c.lengths),t.maxLength&&(l=Math.min(t.maxLength,l));for(var d=0;d<c.lengths.length;d++)if(c.lengths[d]===h.length)return r=h.length<l||o,i(c,r,o);return i(c,h.length<l,!1)}return K.cardNumber=s,K}var O={},Y={},G={},xt;function $e(){if(xt)return G;xt=1,Object.defineProperty(G,"__esModule",{value:!0}),G.expirationYear=void 0;var a=19;function n(s,e,t){return{isValid:s,isPotentiallyValid:e,isCurrentYear:t||!1}}function i(s,e){e===void 0&&(e=a);var t;if(typeof s!="string")return n(!1,!1);if(s.replace(/\s/g,"")==="")return n(!1,!0);if(!/^\d*$/.test(s))return n(!1,!1);var r=s.length;if(r<2)return n(!1,!0);var o=new Date().getFullYear();if(r===3){var l=s.slice(0,2),h=String(o).slice(0,2);return n(!1,l===h)}if(r>4)return n(!1,!1);var u=parseInt(s,10),c=Number(String(o).substr(2,2)),d=!1;if(r===2){if(String(o).substr(0,2)===s)return n(!1,!0);t=c===u,d=u>=c&&u<=c+e}else r===4&&(t=o===u,d=u>=o&&u<=o+e);return n(d,d,t)}return G.expirationYear=i,G}var X={},St;function Di(){return St||(St=1,Object.defineProperty(X,"__esModule",{value:!0}),X.isArray=void 0,X.isArray=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"}),X}var It;function Ti(){if(It)return Y;It=1,Object.defineProperty(Y,"__esModule",{value:!0}),Y.parseDate=void 0;var a=$e(),n=Di();function i(e){var t=Number(e[0]),r;return t===0?2:t>1||t===1&&Number(e[1])>2?1:t===1?(r=e.substr(1),(0,a.expirationYear)(r).isPotentiallyValid?1:2):e.length===5?1:e.length>5?2:1}function s(e){var t;if(/^\d{4}-\d{1,2}$/.test(e)?t=e.split("-").reverse():/\//.test(e)?t=e.split(/\s*\/\s*/g):/\s/.test(e)&&(t=e.split(/ +/g)),(0,n.isArray)(t))return{month:t[0]||"",year:t.slice(1).join()};var r=i(e),o=e.substr(0,r);return{month:o,year:e.substr(o.length)}}return Y.parseDate=s,Y}var J={},Ct;function jt(){if(Ct)return J;Ct=1,Object.defineProperty(J,"__esModule",{value:!0}),J.expirationMonth=void 0;function a(i,s,e){return{isValid:i,isPotentiallyValid:s,isValidForThisYear:e||!1}}function n(i){var s=new Date().getMonth()+1;if(typeof i!="string")return a(!1,!1);if(i.replace(/\s/g,"")===""||i==="0")return a(!1,!0);if(!/^\d*$/.test(i))return a(!1,!1);var e=parseInt(i,10);if(isNaN(Number(i)))return a(!1,!1);var t=e>0&&e<13;return a(t,t,t&&e>=s)}return J.expirationMonth=n,J}var Rt;function Oi(){if(Rt)return O;Rt=1;var a=O&&O.__assign||function(){return a=Object.assign||function(r){for(var o,l=1,h=arguments.length;l<h;l++){o=arguments[l];for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(r[u]=o[u])}return r},a.apply(this,arguments)};Object.defineProperty(O,"__esModule",{value:!0}),O.expirationDate=void 0;var n=Ti(),i=jt(),s=$e();function e(r,o,l,h){return{isValid:r,isPotentiallyValid:o,month:l,year:h}}function t(r,o){var l;if(typeof r=="string")r=r.replace(/^(\d\d) (\d\d(\d\d)?)$/,"$1/$2"),l=(0,n.parseDate)(String(r));else if(r!==null&&typeof r=="object"){var h=a({},r);l={month:String(h.month),year:String(h.year)}}else return e(!1,!1,null,null);var u=(0,i.expirationMonth)(l.month),c=(0,s.expirationYear)(l.year,o);if(u.isValid){if(c.isCurrentYear){var d=u.isValidForThisYear;return e(d,d,l.month,l.year)}if(c.isValid)return e(!0,!0,l.month,l.year)}return u.isPotentiallyValid&&c.isPotentiallyValid?e(!1,!0,null,null):e(!1,!1,null,null)}return O.expirationDate=t,O}var Q={},$t;function Ai(){if($t)return Q;$t=1,Object.defineProperty(Q,"__esModule",{value:!0}),Q.cvv=void 0;var a=3;function n(t,r){for(var o=0;o<t.length;o++)if(r===t[o])return!0;return!1}function i(t){for(var r=a,o=0;o<t.length;o++)r=t[o]>r?t[o]:r;return r}function s(t,r){return{isValid:t,isPotentiallyValid:r}}function e(t,r){return r===void 0&&(r=a),r=r instanceof Array?r:[r],typeof t!="string"||!/^\d*$/.test(t)?s(!1,!1):n(r,t.length)?s(!0,!0):t.length<Math.min.apply(null,r)?s(!1,!0):t.length>i(r)?s(!1,!1):s(!0,!0)}return Q.cvv=e,Q}var Z={},kt;function Li(){if(kt)return Z;kt=1,Object.defineProperty(Z,"__esModule",{value:!0}),Z.postalCode=void 0;var a=3,n=new RegExp(/^[a-z0-9]+$/i);function i(e,t){return{isValid:e,isPotentiallyValid:t}}function s(e,t){t===void 0&&(t={});var r=t.minLength||a;return typeof e!="string"?i(!1,!1):e.length<r?i(!1,!0):n.test(e.trim().slice(0,r))?i(!0,!0):i(!1,!0)}return Z.postalCode=s,Z}var S,Dt;function Mi(){if(Dt)return S;Dt=1;var a=S&&S.__createBinding||(Object.create?function(d,g,m,p){p===void 0&&(p=m);var v=Object.getOwnPropertyDescriptor(g,m);(!v||("get"in v?!g.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return g[m]}}),Object.defineProperty(d,p,v)}:function(d,g,m,p){p===void 0&&(p=m),d[p]=g[m]}),n=S&&S.__setModuleDefault||(Object.create?function(d,g){Object.defineProperty(d,"default",{enumerable:!0,value:g})}:function(d,g){d.default=g}),i=S&&S.__importStar||function(d){if(d&&d.__esModule)return d;var g={};if(d!=null)for(var m in d)m!=="default"&&Object.prototype.hasOwnProperty.call(d,m)&&a(g,d,m);return n(g,d),g},s=i(Ft()),e=Ri(),t=ki(),r=Oi(),o=jt(),l=$e(),h=Ai(),u=Li(),c={creditCardType:s,cardholderName:e.cardholderName,number:t.cardNumber,expirationDate:r.expirationDate,expirationMonth:o.expirationMonth,expirationYear:l.expirationYear,cvv:h.cvv,postalCode:u.postalCode};return S=c,S}var Vi=Mi();const x=Ot(Vi);function qi(){y.data("cardForm",()=>({model:{number:"",expiry:"",cvc:""},ri:{number:null,expiry:null,cvc:null},errors:{number:null,expiry:null,cvc:null},error:null,card:{},data:{number:null,expire_month:null,expire_year:null,cvc:null},init(){for(let a in this.ri)this.ri[a]=new Pi({element:this.$refs[a],pattern:this.$refs[a].dataset.pattern}),this.$watch("errors."+a,n=>{this.error=this.errors.number||this.errors.expiry||this.errors.cvc});this.cardInput(),this.expiryInput(),this.cvcInput()},cardInput(){this.$watch("model.number",(a,n)=>{this.data.number=null,this.errors.number=null;let i=x.number(a);this.card=i.card||{},i.card&&(this.ri.number.setPattern(this.generateCardInputPattern(i)),this.ri.cvc.setPattern("{{"+"9".repeat(i.card.code.size)+"}}"),this.$refs.cvc.setAttribute("placeholder",i.card.code.name),this.$refs.cvc.setAttribute("maxlength",i.card.code.size),this.model.cvc&&this.model.cvc.length<i.card.code.size&&(this.errors.cvc=E("Your card's security code is incomplete."))),a.length>n.length&&i.isValid&&i.card.type!="unionpay"?(x.expirationDate(this.model.expiry).isValid?x.cvv(this.model.cvc).isValid||this.$refs.cvc.focus():this.$refs.expiry.focus(),this.data.number=a):!i.isValid&&!i.isPotentiallyValid&&(this.errors.number=E("Invalid card number"))}),this.$refs.number.addEventListener("blur-xs",()=>{let a=x.number(this.model.number);!a.isValid&&this.model.number.length>0?this.errors.number=a.isPotentiallyValid?E("Your card number is incomplete."):E("Invalid card number"):this.errors.number=null})},expiryInput(){this.$watch("model.expiry",(a,n)=>{this.data.expire_month=null,this.data.expire_year=null,this.errors.expiry=null;let i=x.expirationDate(a);i.isValid?(x.cvv(this.model.cvc).isValid||this.$refs.cvc.focus(),this.data.expire_month=i.month,this.data.expire_year=i.year):a.length==1&&parseInt(a,10)>1?this.model.expiry="0"+a+"/":a.length==3&&parseInt(a.substring(0,2),10)>"12"&&(this.model.expiry="0"+a[0]+"/"+a[1]),i=x.expirationDate(this.model.expiry),i.isPotentiallyValid||(this.errors.expiry=E("Your card's expiration date is invalid."))}),this.$refs.expiry.addEventListener("blur-xs",()=>{let a=x.expirationDate(this.model.expiry);!a.isValid&&this.model.expiry.length>0?this.errors.expiry=a.isPotentiallyValid?E("Your card's expiration date is incomplete."):E("Your card's expiration date is invalid."):this.errors.expiry=null}),this.$refs.expiry.addEventListener("keyup",a=>{a.key=="Backspace"&&this.model.expiry.length==0&&this.$refs.number.focus()})},cvcInput(){this.$watch("model.cvc",(a,n)=>{this.data.cvc=null,this.errors.cvc=null;let i=x.cvv(a,this.$refs.cvc.getAttribute("maxlength")||3);i.isValid?this.data.cvc=a:i.isPotentiallyValid||(this.errors.cvc=E("Your card's security code is invalid."))}),this.$refs.cvc.addEventListener("blur-xs",()=>{let a=x.cvv(this.model.cvc,this.$refs.cvc.getAttribute("maxlength")||3);!a.isValid&&this.model.cvc.length>0?this.errors.cvc=a.isPotentiallyValid?E("Your card's security code is incomplete."):E("Your card's security code is invalid."):this.errors.cvc=null}),this.$refs.cvc.addEventListener("keyup",a=>{a.key=="Backspace"&&this.model.cvc.length==0&&this.$refs.expiry.focus()})},generateCardInputPattern(a){let n=a.card,i="",s=0;n.gaps.forEach((r,o)=>{const l=r-s;i+="{{"+"9".repeat(l)+"}} ",s=r});const t=Math.max(...n.lengths)-s;return i+="{{"+"9".repeat(t)+"}}",i.trim()},icon(){return`<svg><use xlink:href="#icon-${this.card.type||"default"}"></use></svg>`}})),y.data("stripe",(a,n={})=>({stripe:null,elements:null,element:null,error:null,disabled:!0,options:{type:"card",mode:null,amount:null,currency:"usd"},init(){this.options={...this.options,...n},this.stripe=Stripe(a);let i={};this.options.type!="card"&&(i={locale:document.documentElement.lang?document.documentElement.lang.split("-")[0]:"auto",mode:this.options.mode,amount:this.options.amount,currency:this.options.currency.toLowerCase(),fonts:[{cssSrc:"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700"}],appearance:{theme:"stripe",variables:{fontFamily:"Inter, system-ui, sans-serif",fontSizeBase:"1rem",borderRadius:"0.75rem",colorText:getComputedStyle(document.documentElement).getPropertyValue("--color-content"),colorPrimary:getComputedStyle(document.documentElement).getPropertyValue("--color-content"),colorTextSecondary:getComputedStyle(document.documentElement).getPropertyValue("--color-content-dimmed"),colorBackground:getComputedStyle(document.documentElement).getPropertyValue("--color-main"),colorTextPlaceholder:getComputedStyle(document.documentElement).getPropertyValue("--color-content-super-dimmed"),colorDanger:getComputedStyle(document.documentElement).getPropertyValue("--color-failure"),accordionItemSpacing:"0.25rem",gridColumnSpacing:"0.5rem",gridRowSpacing:"0.5rem",pickerItemSpacing:"0.25rem",fontWeightNormal:"500"},rules:{".AccordionItem":{borderColor:getComputedStyle(document.documentElement).getPropertyValue("--color-line-dimmed"),boxShadow:"none",color:getComputedStyle(document.documentElement).getPropertyValue("--color-content")},".Block":{backgroundColor:getComputedStyle(document.documentElement).getPropertyValue("--color-intermediate"),boxShadow:"none",padding:"1rem",border:"none",borderRadius:"0.875rem"},".BlockDivider":{backgroundColor:getComputedStyle(document.documentElement).getPropertyValue("--color-line")},".Label":{fontSize:"0.875rem",lineHeight:"1.25rem",fontWeight:"600",marginBottom:"0.5rem"},".Error":{fontSize:"0.75rem",lineHeight:"1rem",fontWeight:"500",marginTop:"0.5rem"},".Input, .CodeInput":{borderRadius:"0.5rem",boxShadow:"none",fontSize:"1rem",lineHeight:"1.5rem",padding:"0.6875rem 0.75rem"},".PickerItem":{borderRadius:"0.5rem",boxShadow:"none",fontSize:"0.75rem",lineHeight:"1.25rem",fontWeight:"600"}}}}),this.elements=this.stripe.elements(i),this.options.type=="card"?this.element=this.elements.create("card",{style:{base:{fontSize:"16px",color:getComputedStyle(document.documentElement).getPropertyValue("--color-content")}}}):this.element=this.elements.create("payment",{layout:{type:"accordion",radios:!1,visibleAccordionItemsCount:3}}),this.element.mount(this.$refs.element),this.element.on("change",({complete:s,error:e})=>{this.disabled=!s,this.error=e?e.message:null}),document.addEventListener("coupon.applied",s=>{this.options.type!=="card"&&this.element&&this.elements.update({amount:s.detail.plan.sale_price??s.detail.plan.price})}),document.addEventListener("coupon.removed",s=>{this.options.type!=="card"&&this.element&&this.elements.update({amount:s.detail.plan.sale_price??s.detail.plan.price})})},async submit(){if(this.disabled||this.processing)return;this.processing="stripe";let i;try{i=await f.post("/billing/checkout",{id:this.plan.id,gateway:"stripe",coupon:this.coupon.code})}catch(o){let l=await o.json();this.error=l.message||null,this.disabled=!1,this.processing=null;return}let s=await i.json(),e=s.purchase_token,t=window.location.origin+"/payment-callback/"+s.id+"/stripe",r;if(this.options.type=="card")r=await(e.startsWith("seti_")?this.stripe.confirmCardSetup:this.stripe.confirmCardPayment)(e,{payment_method:{card:this.element}});else{const{error:o}=await this.elements.submit();if(o){this.error=o.message,this.disabled=!1,this.processing=null;return}r=await(e.startsWith("seti_")?this.stripe.confirmSetup:this.stripe.confirmPayment)({elements:this.elements,clientSecret:e,confirmParams:{return_url:t}})}if(r.error)this.error=r.error.message,this.disabled=!1,this.processing=null;else{r.setupIntent?t+="?setup_intent="+r.setupIntent.id:t+="?payment_intent="+r.paymentIntent.id,window.location.href=t;return}}})),y.data("checkout",(a={},n=0)=>({plan:a,voiceCount:n,coupon:{code:null,error:null},processing:null,error:null,showAddressForm:!1,proceed:null,applying:!1,offlinePayment:null,init(){this.preCheck()},preCheck(){if(this.plan.member_cap!==null&&this.$store.workspace.users.length+this.$store.workspace.invitations.length>this.plan.member_cap){this.proceed="member_cap";return}if(this.plan.config.voiceover.clone_cap!==null&&this.voiceCount>this.plan.config.voiceover.clone_cap){this.proceed="voice_cap";return}this.proceed=!0},applyCoupon(){this.applying||!this.coupon.code||(this.applying=!0,f.config.toast=!1,f.get("/billing/plans/"+this.plan.id,{coupon:this.coupon.code}).then(i=>{this.plan={...this.plan,...i.data},this.$dispatch("coupon.applied",{plan:this.plan})}).catch(i=>{this.coupon.error=i.message}).finally(()=>{f.config.toast=!0,this.applying=!1}))},removeCoupon(){this.applying||!this.coupon.code||(this.applying=!0,f.get("/billing/plans/"+this.plan.id).then(i=>{this.coupon.code=null,this.coupon.error=null,this.plan={...this.plan,...i.data},this.$dispatch("coupon.removed",{plan:this.plan})}).finally(()=>this.applying=!1))},saveAddress(i,s){this.processing||(this.processing=!0,f.post(`/workspaces/${i}`,new FormData(s)).then(e=>{this.$store.workspace=e.data,this.processing=!1,this.showAddressForm=!1}).catch(e=>this.processing=!1))},purchase(i="",s=null){this.processing||(this.processing=i,f.post("/billing/checkout",{id:this.plan.id,gateway:i,card:s,coupon:this.coupon.code}).then(e=>e.json()).then(e=>{if(e.redirect){window.location.href=e.redirect;return}if(e.id){window.location.href="app/billing/orders/"+e.id+"/receipt";return}this.processing=null}).catch(e=>{let t="An unexpected error occurred! Please try again later!";this.processing=null,this.error=e.message||t}))}}))}function Fi(){y.data("account",a=>({isProcessing:!1,generatingApiKey:!1,user:a,init(){this.user.ip&&this.fetchIpLocation()},async fetchIpLocation(){const n=await Ht.getIpInfo(this.user.ip);n&&(this.user.latitude=n.latitude,this.user.longitude=n.longitude)},generateApiKey(){this.generatingApiKey||(this.generatingApiKey=!0,f.post("/account/rest-api-keys").then(n=>{this.user={...this.user,...n.data},window.modal.open("api-modal"),this.generatingApiKey=!1}).catch(n=>this.generatingApiKey=!1))},submit(){if(this.isProcessing)return;this.isProcessing=!0;let n=new Bt(this.$refs.form);f.post(`/account${this.$refs.form.dataset.path||""}`,n).then(i=>i.json()).then(i=>{i.jwt&&localStorage.setItem("jwt",i.jwt),this.user={...this.user,...i},this.isProcessing=!1,w.success(this.$refs.form.dataset.successMsg||"Changes saved successfully!")}).catch(i=>{this.isProcessing=!1})},resendIn:0,resendVerificationEmail(){if(this.resent)return;this.resendIn=60;let n=setInterval(()=>{this.resendIn--,this.resendIn<=0&&clearInterval(n)},1e3);f.post("/account/verification").then(()=>w.success("Email sent successfully!"))}}))}function ji(){y.data("quickAccess",()=>({isProcessing:!1,showResults:!1,results:[],init(){this.bindKeyboardShortcuts()},bindKeyboardShortcuts(){window.addEventListener("keydown",a=>{a.metaKey&&a.key==="k"?(a.preventDefault(),this.$refs.input.focus()):a.key==="Escape"&&(this.$refs.input.blur(),this.showResults=!1)})}})),y.data("dashboard",()=>({documents:[],documentsFetched:!1,usageDataset:[],init(){this.checkPendingRedirection(),this.getRecentDocuments(),this.getUsageDataset()},getRecentDocuments(){let a={limit:5,sort:"created_at:desc"};f.get("/library/documents",a).then(n=>n.json()).then(n=>{this.documentsFetched=!0,this.documents=n.data})},checkPendingRedirection(){let a=Le.getRedirectPath();a&&(Le.clearRedirectPath(),window.location.href=a)},getUsageDataset(){f.get("/workspaces/"+this.$store.workspace.id+"/datasets/usage",{limit:30}).then(a=>a.json()).then(a=>{this.usageDataset=a})}}))}function Bi(){y.data("voiceover",(a=null,n=null)=>({isProcessing:!1,isDeleting:!1,history:[],historyLoaded:!1,preview:n,showSettings:!1,voice:a,prompt:null,query:"",voices:null,isLoading:!1,hasMore:!0,currentResource:null,showList:!1,init(){this.$watch("preview",i=>{if(this.history&&i){let s=this.history.findIndex(e=>e.id===i.id);s>=0&&(this.history[s]=i)}}),this.fetchHistory(),this.getVoices()},fetchHistory(){let i={limit:25};this.history&&this.history.length>0&&(i.starting_after=this.history[this.history.length-1].id),f.get("/library/speeches",i).then(s=>s.json()).then(s=>{let e=s.data;this.history.push(...e),e.length<i.limit&&(this.historyLoaded=!0)})},getVoices(i=null,s=!1){if(s&&(this.isLoading=!1,this.hasMore=!0),!this.hasMore||this.isLoading)return;this.isLoading=!0;let e={limit:25};i&&(e.starting_after=i),this.query&&(e.query=this.query),f.get("/voices",e).then(t=>t.json()).then(t=>{this.isLoading=!1,this.voices||(this.voices=[]),s?this.voices=t.data:this.voices.push(...t.data),this.hasMore=t.data.length>=e.limit})},submit(){if(this.isProcessing)return;this.isProcessing=!0;let i={voice_id:this.voice.id,prompt:this.prompt};f.post("/ai/speeches",i).then(s=>s.json()).then(s=>{this.history===null&&(this.history=[]),this.history.push(s),this.preview=s,this.isProcessing=!1,this.prompt=null,this.select(s)}).catch(s=>{this.isProcessing=!1,console.error(s)})},select(i){this.preview=i;let s=new URL(window.location.href);s.pathname="/app/voiceover/"+i.id,window.history.pushState({},"",s),i.voice&&(this.voice=i.voice)},save(i){f.post(`/library/speeches/${i.id}`,{title:i.title})},remove(i){this.isDeleting=!0,f.delete(`/library/speeches/${i.id}`).then(()=>{var e;this.preview=null,window.modal.close(),toast.show("Speech has been deleted successfully.","ti ti-trash"),this.isDeleting=!1;let s=new URL(window.location.href);s.pathname="/app/voiceover/"+(((e=this.voice)==null?void 0:e.id)||this.voices[0]||""),window.history.pushState({},"",s),this.history.splice(this.history.indexOf(i),1)}).catch(s=>this.isDeleting=!1)},selectVoice(i){this.voice=i,window.modal.close();let s=new URL(window.location.href);s.pathname="/app/voiceover/"+i.id,window.history.pushState({},"",s)}})),y.data("clone",()=>({file:null,isProcessing:!1,name:null,consent:!1,isRecording:!1,mediaRecorder:null,recordingTime:"00:00",recordingTimer:null,error:null,audioChunks:[],visualizerBars:Array.from({length:10},(a,n)=>({id:n,active:!1,height:20})),audioContext:null,analyser:null,dataArray:null,animationFrame:null,init(){this.audioContext=new(window.AudioContext||window.webkitAudioContext)},startRecording(){navigator.mediaDevices.getUserMedia({audio:!0}).then(a=>{this.error=null,this.isRecording=!0,this.mediaRecorder=new MediaRecorder(a,{mimeType:"audio/webm;codecs=opus",audioBitsPerSecond:128e3}),this.audioChunks=[],this.audioContext.state==="suspended"&&this.audioContext.resume();const n=this.audioContext.createMediaStreamSource(a);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=32,n.connect(this.analyser),this.dataArray=new Uint8Array(this.analyser.frequencyBinCount),this.updateVisualizer(),this.mediaRecorder.ondataavailable=s=>{this.audioChunks.push(s.data)},this.mediaRecorder.onstop=async()=>{const s=new Blob(this.audioChunks,{type:"audio/webm"});try{const e=new(window.AudioContext||window.webkitAudioContext),t=await s.arrayBuffer(),r=await e.decodeAudioData(t),o=await this.audioBufferToWav(r);this.selectFile(new File([o],"voice_sample.wav",{type:"audio/wav"}))}catch(e){console.error("Error converting to WAV:",e),this.error="conversion_error"}this.isRecording=!1,clearInterval(this.recordingTimer),this.recordingTime="00:00"},this.mediaRecorder.start();let i=0;this.recordingTimer=setInterval(()=>{i++;const s=Math.floor(i/60),e=i%60;this.recordingTime=`${s.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}`,i>=30&&this.stopRecording()},1e3)}).catch(a=>{console.error("Error accessing microphone:",a),this.error="microphone_error"})},updateVisualizer(){if(!this.isRecording)return;this.analyser.getByteFrequencyData(this.dataArray);const n=Array.from(this.dataArray).slice(0,10).reduce((s,e)=>s+e,0)/10/255,i=Math.floor(n*this.visualizerBars.length);this.visualizerBars.forEach((s,e)=>{s.active=e<i;let t=20,o=Math.sin(Date.now()/200+e*.8)*12;s.active?s.height=t+Math.abs(o):s.height=t}),this.animationFrame=requestAnimationFrame(()=>this.updateVisualizer())},stopRecording(){this.mediaRecorder&&this.mediaRecorder.state!=="inactive"&&(this.mediaRecorder.stop(),this.mediaRecorder.stream.getTracks().forEach(a=>a.stop()),this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.visualizerBars=this.visualizerBars.map(a=>({...a,active:!1,height:20})),this.analyser&&(this.analyser.disconnect(),this.analyser=null))},selectFile(a){if(a.size>5242880){this.error="file_size";return}if(!a.type.startsWith("audio/")&&!a.type.startsWith("video/")){this.error="file_type";return}this.error=null,this.file=a},clone(){if(this.isProcessing)return;this.isProcessing=!0;let a=new FormData;a.append("name",this.name),a.append("consent",this.consent?1:0),a.append("file",this.file),f.post("/voices",a).then(n=>n.json()).then(n=>{this.file=null,this.name=null,this.consent=!1,this.isRecording=!1,this.audioContext.close(),this.resources.unshift(n),toast.success("Voice has been cloned successfully.")}).finally(()=>{this.isProcessing=!1,window.modal.close()})},audioBufferToWav(a){const n=a.numberOfChannels,i=a.sampleRate,s=a.length*n*2,e=new ArrayBuffer(44+s),t=new DataView(e),r=(h,u,c)=>{for(let d=0;d<c.length;d++)h.setUint8(u+d,c.charCodeAt(d))};r(t,0,"RIFF"),t.setUint32(4,36+s,!0),r(t,8,"WAVE"),r(t,12,"fmt "),t.setUint32(16,16,!0),t.setUint16(20,1,!0),t.setUint16(22,n,!0),t.setUint32(24,i,!0),t.setUint32(28,i*2,!0),t.setUint16(32,n*2,!0),t.setUint16(34,16,!0),r(t,36,"data"),t.setUint32(40,s,!0);const o=[];for(let h=0;h<n;h++)o[h]=a.getChannelData(h);let l=44;for(let h=0;h<a.length;h++)for(let u=0;u<n;u++){const c=Math.max(-1,Math.min(1,o[u][h]));t.setInt16(l,c<0?c*32768:c*32767,!0),l+=2}return new Blob([t],{type:"audio/wav"})}})),y.data("voice",a=>({voice:null,isProcessing:null,init(){this.voice={...a}},edit(){this.isProcessing=!0,f.post(`/voices/${this.voice.id}`,{name:this.voice.name,visibility:this.voice.visibility}).then(n=>n.json()).then(n=>{this.voice={...n},Object.assign(a,n),window.modal.close()}).finally(()=>{this.isProcessing=!1})}})),y.data("audience",a=>({item:a,isProcessing:null,changeAudience(n){this.isProcessing=n,f.post(`/library/${this.item.id}`,{visibility:n}).then(i=>i.json()).then(i=>{window.modal.close(),this.isProcessing=null,this.item=i})}}))}function Ui(){y.data("imagine",(a,n=[],i=[],s=null)=>({samples:i,services:n,model:null,showSettings:!1,history:[],historyLoaded:!1,isProcessing:!1,isDeleting:!1,preview:null,prompt:null,negativePrompt:null,images:[],params:{},original:{},placeholder:null,timer:0,form:!0,init(){this.$watch("preview",e=>{if(this.history&&e){let t=this.history.findIndex(r=>r.id===e.id);t>=0&&(this.history[t]=e)}}),this.selectModel(a),this.$watch("model",()=>this.reset()),s&&this.select(s),this.fetchHistory()},selectModel(e){let t=!1;this.services.forEach(r=>{r.models.forEach(o=>{o.key==e&&(this.model={...o,service:r},t=!0)})}),!t&&this.services.length>0&&this.services[0].models.length>0&&(this.model={...this.services[0].models[0],service:this.services[0]},t=!0),t||(this.model=null),this.reset()},fetchHistory(){let e={limit:24};this.history&&this.history.length>0&&(e.starting_after=this.history[this.history.length-1].id),f.get("/library/images",e).then(t=>t.json()).then(t=>{let r=t.data;this.history.push(...r),r.length<e.limit&&(this.historyLoaded=!0)})},reset(){for(let e in this.params){if(this.original[e]===void 0){delete this.params[e];continue}this.params[e]=this.original[e]}this.images=[]},typeWrite(e,t){let r=0,o=10,l=()=>{r<t.length&&(this[e]+=t.charAt(r),r++,clearTimeout(this.timer),this.timer=setTimeout(l,o))};this[e]="",l()},surprise(){let e=this.samples[Math.floor(Math.random()*this.samples.length)];this.$refs.prompt.focus(),this.typeWrite("prompt",e)},placeholderSurprise(){clearTimeout(this.timer),!this.prompt&&(this.timer=setTimeout(()=>{let e=this.samples[Math.floor(Math.random()*this.samples.length)];this.typeWrite("placeholder",e)},2e3))},tab(e){this.prompt!=this.placeholder&&this.placeholder&&(e.preventDefault(),this.prompt=this.placeholder)},blur(){this.placeholder=null,clearTimeout(this.timer)},submit(e){if(this.isProcessing)return;this.isProcessing=!0,this.preview=null;let t={...this.params,prompt:this.prompt,negative_prompt:this.negativePrompt,model:this.model.key||null},r=new FormData;for(let o in t)r.append(o,t[o]);for(let o of this.images)r.append("images[]",o);f.post("/ai/images",r).then(o=>o.json()).then(o=>{this.history.unshift(o),this.select(o),this.prompt=null}).catch(o=>{let l=new URL(window.location.href);l.pathname="/app/imagine/",window.history.pushState({},"",l)}).finally(()=>{this.isProcessing=!1})},select(e){this.preview=e,this.form=!1;let t=new URL(window.location.href);t.pathname="/app/imagine/"+e.id,window.history.pushState({},"",t),this.checkProgress()},remove(e){this.isDeleting=!0,f.delete(`/library/images/${e.id}`).then(()=>{this.preview=null,this.form=!0,window.modal.close(),w.show("Image has been deleted successfully.","ti ti-trash"),this.isDeleting=!1;let t=new URL(window.location.href);t.pathname="/app/imagine/",window.history.pushState({},"",t),this.history.splice(this.history.indexOf(e),1)}).catch(t=>this.isDeleting=!1)},copyImgToClipboard(e){fetch(e.output_file.url).then(t=>t.blob()).then(t=>{let r=new ClipboardItem({[t.type]:t});return navigator.clipboard.write([r])}).then(()=>{w.success("Image copied to clipboard!")})},checkProgress(){this.preview.state>=3||f.get(`/library/images/${this.preview.id}`).then(e=>e.json()).then(e=>{this.preview=e,setTimeout(()=>this.checkProgress(),5e3)})},save(e){f.post(`/library/images/${e.id}`,{title:e.title}).then(t=>{this.updateHistory(t.data)})},addImage(e){const t=Array.from(e.target.files),r=this.model.config.images.limit||1;this.images=[...this.images,...t.slice(0,r-this.images.length)],e.target.value=null,window.modal.open("options")},removeImage(e){this.images=this.images.filter(t=>t!==e)},updateHistory(e){let t=this.history.findIndex(r=>r.id===e.id);t>=0&&(this.history[t]=e)},actionNew(){this.prompt=null,this.negativePrompt=null,this.params={},this.images=[],this.form=!0;let e=new URL(window.location.href);e.pathname="/app/imagine/",window.history.pushState({},"",e),this.$nextTick(()=>{this.$refs.prompt.focus()})},actionEdit(){var r,o;this.prompt=((r=this.preview.params)==null?void 0:r.prompt)||null,this.negativePrompt=((o=this.preview.params)==null?void 0:o.negative_prompt)||null;let e={...this.preview.params};delete e.prompt,delete e.negative_prompt,this.selectModel(this.preview.model),this.form=!0,this.$nextTick(()=>{this.params=e});let t=new URL(window.location.href);t.pathname="/app/imagine/",window.history.pushState({},"",t),this.$nextTick(()=>{this.$refs.prompt.focus()})}}))}function Ni(){y.data("workspace",(a=null,n=null)=>({workspace:a,user:n,isSwithcing:null,isProcessing:!1,currentResource:null,voices:[],voiceCount:0,init(){},switchWorkspace(i){this.isSwithcing||(this.isSwithcing=i,f.post("/account/workspace",{id:i}).then(()=>{w.defer("Workspace switched!"),window.location.reload()}))},rename(i,s){this.isProcessing||(this.isProcessing=!0,f.patch(`/workspaces/${i}`,{name:s}).then(e=>e.json()).then(e=>{this.$store.workspace=e,this.isProcessing=!1,w.success("Workspace name updated!"),window.modal.close()}).catch(e=>this.isProcessing=!1))},saveKeys(i){this.isProcessing||(this.isProcessing=!0,f.patch(`/workspaces/${i}`,{openai_api_key:this.$store.workspace.openai_api_key,anthropic_api_key:this.$store.workspace.anthropic_api_key}).then(s=>{this.$store.workspace=s.data,this.isProcessing=!1,w.success("Changes saved successfully!")}))},create(i){this.isProcessing||(this.isProcessing=!0,f.post("/workspaces",{name:i}).then(()=>{w.defer("Workspace created!"),window.location="/app/workspace"}).catch(s=>this.isProcessing=!1))},removeMember(i,s){this.isProcessing=!0,f.delete(`/workspaces/${i}/users/${s}`).then(e=>{this.isProcessing=!1,e.json().then(t=>{this.$store.workspace=t,w.success("Member removed!")}).catch(t=>{w.show("Leaving workspace...","ti ti-progress"),setTimeout(()=>window.location.reload(),2e3)})}).catch(e=>this.isProcessing=!1)},inviteMember(i,s){this.isProcessing=!0,f.post(`/workspaces/${i}/invitations`,{email:s}).then(e=>e.json()).then(e=>{this.isProcessing=!1,this.$store.workspace=e,w.success("Invitation sent!"),window.modal.close()}).catch(e=>this.isProcessing=!1)},deleteInvitation(i,s){this.isProcessing=!0,f.delete(`/workspaces/${i}/invitations/${s}`).then(e=>e.json()).then(e=>{this.isProcessing=!1,this.$store.workspace=e,w.success("Invitation removed!")}).catch(e=>this.isProcessing=!1)},deleteWorkspace(i){this.isProcessing=!0,f.delete(`/workspaces/${i}`).then(()=>{w.defer("Workspace deleted!","ti ti-trash"),window.location.reload()}).catch(s=>this.isProcessing=!1)},transferOwnership(i,s){this.isProcessing=!0,f.patch(`/workspaces/${i}`,{owner_id:s}).then(e=>e.json()).then(e=>{this.isProcessing=!1,this.$store.workspace=e,w.success("Workspace ownership transferred!"),window.modal.close()}).catch(e=>this.isProcessing=!1)},fetchClonedVoices(){f.get("/voices/count?owner=workspace").then(i=>this.voiceCount=i.data.count),f.get("/voices?owner=workspace&limit=3").then(i=>this.voices=i.data.data)}}))}var Hi=Object.defineProperty,Wi=(a,n,i)=>n in a?Hi(a,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[n]=i,te=(a,n,i)=>Wi(a,typeof n!="symbol"?n+"":n,i);class Tt extends Error{constructor(n,i){super(n),te(this,"type"),te(this,"field"),te(this,"value"),te(this,"line"),this.name="ParseError",this.type=i.type,this.field=i.field,this.value=i.value,this.line=i.line}}function Ce(a){}function zi(a){const{onEvent:n=Ce,onError:i=Ce,onRetry:s=Ce,onComment:e}=a;let t="",r=!0,o,l="",h="";function u(p){const v=r?p.replace(/^\xEF\xBB\xBF/,""):p,[_,P]=Ki(`${t}${v}`);for(const I of _)c(I);t=P,r=!1}function c(p){if(p===""){g();return}if(p.startsWith(":")){e&&e(p.slice(p.startsWith(": ")?2:1));return}const v=p.indexOf(":");if(v!==-1){const _=p.slice(0,v),P=p[v+1]===" "?2:1,I=p.slice(v+P);d(_,I,p);return}d(p,"",p)}function d(p,v,_){switch(p){case"event":h=v;break;case"data":l=`${l}${v}
`;break;case"id":o=v.includes("\0")?void 0:v;break;case"retry":/^\d+$/.test(v)?s(parseInt(v,10)):i(new Tt(`Invalid \`retry\` value: "${v}"`,{type:"invalid-retry",value:v,line:_}));break;default:i(new Tt(`Unknown field "${p.length>20?`${p.slice(0,20)}`:p}"`,{type:"unknown-field",field:p,value:v,line:_}));break}}function g(){l.length>0&&n({id:o,event:h||void 0,data:l.endsWith(`
`)?l.slice(0,-1):l}),o=void 0,l="",h=""}function m(p={}){t&&p.consume&&c(t),o=void 0,l="",h="",t=""}return{feed:u,reset:m}}function Ki(a){const n=[];let i="";const s=a.length;for(let e=0;e<s;e++){const t=a[e];t==="\r"&&a[e+1]===`
`?(n.push(i),i="",e++):t==="\r"||t===`
`?(n.push(i),i=""):i+=t}return[n,i]}class ke extends TransformStream{constructor({onError:n,onRetry:i,onComment:s}={}){let e;super({start(t){e=zi({onEvent:r=>{t.enqueue(r)},onError(r){n==="terminate"?t.error(r):typeof n=="function"&&n(r)},onRetry:i,onComment:s})},transform(t){e.feed(t)}})}}function De(a,n,i){for(const s in n){if(!n.hasOwnProperty(s))continue;let e=s,t=n[s];if(typeof t>"u"&&(t=""),t===null&&(t=""),typeof i<"u"&&(e=i+"["+s+"]"),t.constructor===Array)e+="[]";else if(typeof t=="object"){De(a,t,e);continue}const r=a.elements.namedItem(e);if(!r)continue;const o=r.type||r[0].type;switch(o){default:r.value=t;break;case"radio":case"checkbox":{const h=t.constructor===Array?t:[t];for(let u=0;u<r.length;u++)r[u].checked=h.indexOf(r[u].value)>-1}break;case"select-multiple":{const h=t.constructor===Array?t:[t];for(let u=0;u<r.options.length;u++)r.options[u].selected=h.indexOf(r.options[u].value)>-1}break;case"select":case"select-one":r.value=t.toString()||t;break;case"date":r.value=new Date(t).toISOString().split("T")[0];break}const l=new Event("change",{bubbles:!0});switch(o){default:r.dispatchEvent(l);break;case"radio":case"checkbox":for(let h=0;h<r.length;h++)r[h].checked&&r[h].dispatchEvent(l);break}}}function Yi(){y.data("writer",(a=null,n=null)=>({required:[],isProcessing:!1,showForm:!0,isDeleting:!1,docs:[],index:0,preset:a,init(){n&&(this.showForm=!1,this.docs.push(n),De(this.$refs.form,n.params)),this.$watch("index",i=>{this.docs[i].id&&this.select(this.docs[i])})},async submit(i=null){if(this.isProcessing)return;this.docs.push({}),this.index=this.docs.length-1;let s=this.docs.length-1;this.isProcessing=!0,this.showForm=!1,i||(i={},new FormData(this.$refs.form).forEach((e,t)=>i[t]=e));try{const r=(await f.post(`/ai/completions/${this.preset?this.preset.id:""}`,i)).body.pipeThrough(new TextDecoderStream).pipeThrough(new ke).getReader();for(;;){const{value:o,done:l}=await r.read();if(l){this.isProcessing=!1;break}if(o.event=="token"){this.docs[s].content=(this.docs[s].content||"")+JSON.parse(o.data).data;continue}if(o.event=="document"){this.docs[s]=JSON.parse(o.data),this.select(this.docs[s]);continue}if(o.event=="error"){this.isProcessing=!1,this.showForm=!0,this.docs.splice(s,1),this.index=this.docs.length>1?this.docs.length-1:0,w.error(o.data);break}}}catch{this.isProcessing=!1,this.showForm=!0,this.docs.pop(),this.index=this.docs.length>1?this.docs.length-1:0}},format(i){return At(i)},copyDocumentContents(i){navigator.clipboard.writeText(i.content).then(()=>{w.success("Document copied to clipboard!")})},download(i,s){if(s=="markdown")var e="text/markdown",t="md",r=i.content;else if(s=="html")var e="text/html",t="html",r=`<html><head><meta charset="utf-8" /><title>${i.title}</title></head><body>${this.format(i.content)}</body></html>`;else if(s=="word")var e="application/vnd.ms-word",t="doc",r=`<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="utf-8" /><title>${i.title}</title></head><body>${this.format(i.content)}</body></html>`;else var e="text/plain",t="txt",r=i.content;this.downloadFromUrl(`data:${e};charset=utf-8,${encodeURIComponent(r)}`,i.title,t)},downloadFromUrl(i,s,e){const t=document.createElement("a");t.href=i,t.download=`${s}.${e}`,document.body.appendChild(t),t.click(),document.body.removeChild(t)},saveDocument(i){f.post(`/library/documents/${i.id}`,i)},deleteDocument(i){this.isDeleting=!0,f.delete(`/library/documents/${i.id}`).then(()=>{w.success("Document deleted successfully!"),this.docs=this.docs.filter(s=>s.id!=i.id),this.index=this.docs.length>1?this.docs.length-1:0,this.docs.length==0&&(this.showForm=!0)}).finally(()=>{this.isDeleting=!1,window.modal.close()})},select(i){let s=new URL(window.location.href);s.pathname="/app/writer/"+(i.id??""),window.history.pushState({},"",s)}}))}function Gi(){y.data("coder",(a=null)=>({required:[],isProcessing:!1,showForm:!0,isDeleting:!1,docs:[],index:0,init(){a&&(this.showForm=!1,this.docs.push(a),De(this.$refs.form,a.params)),this.$watch("index",n=>{this.docs[n].id&&this.select(this.docs[n])})},async submit(n=null){if(this.isProcessing)return;this.docs.push({}),this.index=this.docs.length-1;let i=this.docs.length-1;this.isProcessing=!0,this.showForm=!1,n||(n={},new FormData(this.$refs.form).forEach((s,e)=>n[e]=s));try{const t=(await f.post("/ai/completions/code",n)).body.pipeThrough(new TextDecoderStream).pipeThrough(new ke).getReader();for(;;){const{value:r,done:o}=await t.read();if(o){this.isProcessing=!1;break}if(r.event=="token"){this.docs[i].content=(this.docs[i].content||"")+JSON.parse(r.data).data;continue}if(r.event=="document"){this.docs[i]=JSON.parse(r.data),this.select(this.docs[i]);continue}if(r.event=="error"){this.isProcessing=!1,this.showForm=!0,this.docs.splice(i,1),this.index=this.docs.length>1?this.docs.length-1:0,w.error(r.data);break}}}catch{this.isProcessing=!1,this.showForm=!0,this.docs.pop(),this.index=this.docs.length>1?this.docs.length-1:0}},format(n){return At(n)},copyDocumentContents(n){navigator.clipboard.writeText(n.content).then(()=>{w.success("Document copied to clipboard!")})},download(n,i){if(i=="markdown")var s="text/markdown",e="md",t=n.content;else if(i=="html")var s="text/html",e="html",t=`<html><head><meta charset="utf-8" /><title>${n.title}</title></head><body>${this.format(n.content)}</body></html>`;else if(i=="word")var s="application/vnd.ms-word",e="doc",t=`<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="utf-8" /><title>${n.title}</title></head><body>${this.format(n.content)}</body></html>`;else var s="text/plain",e="txt",t=n.content;this.downloadFromUrl(`data:${s};charset=utf-8,${encodeURIComponent(t)}`,n.title,e)},downloadFromUrl(n,i,s){const e=document.createElement("a");e.href=n,e.download=`${i}.${s}`,document.body.appendChild(e),e.click(),document.body.removeChild(e)},saveDocument(n){f.post(`/library/code-documents/${n.id}`,n)},deleteDocument(n){this.isDeleting=!0,f.delete(`/library/code-documents/${n.id}`).then(()=>{w.success("Document deleted successfully!"),this.docs=this.docs.filter(i=>i.id!=n.id),this.index=this.docs.length>1?this.docs.length-1:0,this.docs.length==0&&(this.showForm=!0)}).finally(()=>{this.isDeleting=!1,window.modal.close()})},select(n){let i=new URL(window.location.href);i.pathname="/app/coder/"+(n.id??""),window.history.pushState({},"",i)}}))}function Xi(){y.data("transcriber",(a=null)=>({isProcessing:!1,isDeleting:!1,history:[],historyLoaded:!1,preview:a,previewTime:0,file:null,viewSegments:!0,error:null,init(){this.$watch("preview",n=>{if(this.history&&n){let i=this.history.findIndex(s=>s.id===n.id);i>=0&&(this.history[i]=n)}}),this.fetchHistory()},fetchHistory(){let n={limit:25};this.history&&this.history.length>0&&(n.starting_after=this.history[this.history.length-1].id),f.get("/library/transcriptions",n).then(i=>i.json()).then(i=>{let s=i.data;this.history.push(...s),s.length<n.limit&&(this.historyLoaded=!0)})},selectFile(n){let i=this.isFileValid(n);this.file=i?n:null},isFileValid(n){const i=["audio/flac","audio/mp3","audio/mpeg","audio/mpga","audio/m4a","audio/ogg","audio/wav","audio/webm","video/mp4","video/webm"];return n.size>25*1024*1024?(w.error(E("File size must be less than 25MB.")),!1):i.includes(n.type)?!0:(w.error("File must be in a supported audio/video format."),!1)},submit(n){this.isProcessing||(this.isProcessing=!0,f.post("/ai/transcriptions",new FormData(n)).then(i=>i.json()).then(i=>{this.history===null&&(this.history=[]),this.history.push(i),this.select(i),this.isProcessing=!1,n.reset(),this.file=null}).catch(i=>this.isProcessing=!1))},save(n){f.post(`/library/transcriptions/${n.id}`,{title:n.title})},select(n){this.preview=n;let i=new URL(window.location.href);i.pathname="/app/transcriber/"+n.id,window.history.pushState({},"",i)},remove(n){this.isDeleting=!0,f.delete(`/library/transcriptions/${n.id}`).then(()=>{this.preview=null,window.modal.close(),w.show("Transcription has been deleted successfully.","ti ti-trash"),this.isDeleting=!1;let i=new URL(window.location.href);i.pathname="/app/transcriber/",window.history.pushState({},"",i),this.history.splice(this.history.indexOf(n),1)}).catch(i=>this.isDeleting=!1)},getReadableDuration(n){let i=new Date(0);return i.setSeconds(n),n>3600?i.toISOString().substring(11,19):i.toISOString().substring(14,19)},download(n,i){if(i=="vtt")s="text/vtt",e="vtt",t=this.toVTT(n);else if(i=="srt")s="text/srt",e="srt",t=this.toSRT(n);else var s="text/plain",e="txt",t=n.content.text;this.downloadFromUrl(`data:${s};charset=utf-8,${encodeURIComponent(t)}`,n.title,e)},downloadFromUrl(n,i,s){const e=document.createElement("a");e.href=n,e.download=`${i}.${s}`,document.body.appendChild(e),e.click(),document.body.removeChild(e)},toVTT(n){let i=`WEBVTT

`;return n.content.segments.forEach((s,e)=>{let t=new Date(0);t.setSeconds(s.start),t=t.toISOString().substring(11,23);let r=new Date(0);r.setSeconds(s.end),r=r.toISOString().substring(11,23),i+=`${e+1}
`,i+=`${t} --> ${r}
`,i+=`${s.text.trim()}

`}),i},toSRT(n){let i="";return n.content.segments.forEach((s,e)=>{let t=new Date(0);t.setSeconds(s.start),t=t.toISOString().substring(11,23).replace(".",",");let r=new Date(0);r.setSeconds(s.end),r=r.toISOString().substring(11,23).replace(".",","),i+=`${e+1}
`,i+=`${t} --> ${r}
`,i+=`${s.text.trim()}

`}),i}}))}function Ji(){y.data("chat",(a,n=[],i=null,s=null)=>({adapters:[],adapter:null,conversation:null,assistant:i,history:[],historyLoaded:!1,assistants:null,tree:[],map:null,file:null,prompt:null,isProcessing:!1,parent:null,quote:null,contentElement:null,isDeleting:!1,query:"",options:{assistant:null,model:null,message:null},init(){var o;this.contentElement=document.getElementById("content"),n.forEach(l=>{l.is_available&&l.models.forEach(h=>{h.is_available&&h.is_enabled&&this.adapters.push(h)})});let e=((o=this.assistant)==null?void 0:o.model)||a;this.adapter=this.adapters.find(l=>l.model==e),!this.adapter&&this.adapters.length>0&&(this.adapter=this.adapters[0]),s&&(this.select(s),setTimeout(()=>this.scrollToBottom(),500)),this.fetchHistory(),this.getAssistants(),window.addEventListener("mouseup",l=>{this.$refs.quote.classList.add("hidden"),this.$refs.quote.classList.remove("flex")});let r=new URL(window.location.href).searchParams.get("q");r&&(this.prompt=r,this.submit())},select(e){this.conversation=e,this.map=new Map,this.conversation.messages.forEach(h=>{this.map.set(h.id,h)}),this.generateTree();let t=new URL(window.location.href);if(t.pathname="/app/chat/"+e.id,t.search="",window.history.pushState({},"",t),this.tree.length===0)return;let r=this.tree[this.tree.length-1],o=r.children[r.index],l=this.adapters.find(h=>h.model===o.model);l&&(this.adapter=l),this.selectAssistant(o.assistant)},generateTree(e=null){if(e&&!this.map.has(e))return;this.tree.splice(0);let t=null;for(;;){let r={index:0,children:[]};this.map.forEach(l=>{t===l.parent_id&&r.children.push(l)});let o=r.children.map(l=>l.id);if(r.children.length>0){if(e){let l=this.map.get(e);for(;l;){if(o.indexOf(l.id)>=0){r.index=o.indexOf(l.id);break}if(l.parent_id){l=this.map.get(l.parent_id);continue}break}}this.tree.push(r),t=r.children[r.index].id;continue}break}},findMessage(e){if(this.map.has(e))return this.map.get(e);if(!this.history)return null;for(const t of this.history){let r=t.messages.find(o=>o.id===e);if(r)return r}return null},addMessage(e){let t=this.findConversation(e.conversation.id||e.conversation);if(!t)return;let r=this.isMessageVisible(e.id);if(e.conversation.id){for(const[o,l]of Object.entries(e.conversation));t.title=e.conversation.title,t.cost=e.conversation.cost}if(!t.messages.find(o=>o.id===e.id))t.messages.push(e),t.id==this.conversation.id&&(r=!0);else{let o=t.messages.findIndex(l=>l.id===e.id);e.reasoning=t.messages[o].reasoning,t.messages[o]=e}!this.conversation||t.id!=this.conversation.id||(this.map.set(e.id,e),r&&this.generateTree(e.id))},findConversation(e){return this.conversation&&this.conversation.id===e?this.conversation:this.history?this.history.find(t=>t.id===e):null},markAsSilent(){var e;this.history&&this.history.forEach(t=>{t.messages.forEach(r=>{r.isProcessing&&(r.silent=!0)})}),(e=this.conversation)!=null&&e.messages&&this.conversation.messages.forEach(t=>{t.isProcessing&&(t.silent=!0)})},isMessageVisible(e){return this.tree.some(t=>{var r;return((r=t.children[t.index])==null?void 0:r.id)===e})},fetchHistory(){let e={limit:25};this.history&&this.history.length>0&&(e.starting_after=this.history[this.history.length-1].id),f.get("/library/conversations",e).then(t=>t.json()).then(t=>{let r=t.data;this.history.push(...r),r.length<e.limit&&(this.historyLoaded=!0)})},getAssistants(e=null){let t={limit:250};e&&(t.starting_after=e),f.get("/assistants",t).then(r=>r.json()).then(r=>{this.assistants||(this.assistants=[]),this.assistants.push(...r.data),r.data.length>0&&r.data.length==t.limit&&this.getAssistants(this.assistants[this.assistants.length-1].id)})},stopProcessing(){this.isProcessing=!1},async submit(){var r;if(this.isProcessing)return;if(this.isProcessing=!0,!this.conversation)try{await this.createConversation()}catch{this.stopProcessing();return}let e=new FormData;e.append("content",this.prompt),e.append("model",this.adapter.model),(r=this.assistant)!=null&&r.id&&e.append("assistant_id",this.assistant.id),this.quote&&e.append("quote",this.quote);let t=document.getElementsByClassName("message");if(t.length>0){let o=t[t.length-1].dataset.id;o&&e.append("parent_id",o)}this.file&&e.append("file",this.file),this.ask(e)},async ask(e){try{const o=(await f.post("/ai/conversations/"+this.conversation.id+"/messages",e)).body.pipeThrough(new TextDecoderStream).pipeThrough(new ke).getReader();this.file=null;let l;for(;;){this.isProcessing&&(this.quote=null,this.prompt=null,this.isProcessing=!1,this.markAsSilent());const{value:h,done:u}=await o.read();if(u){this.stopProcessing(),l&&(l.call=null,l.isProcessing=!1,this.isMessageVisible(l.id)&&this.generateTree(l.id));break}if(h.event=="token"||h.event=="reasoning-token"){let c=JSON.parse(h.data);if(l=this.findMessage(c.attributes.message_id),l){const d=Date.now();h.event=="reasoning-token"?(l.silent?l.pendingReasoning=(l.pendingReasoning||"")+c.data:l.reasoning+=(l.pendingReasoning||"")+c.data,l.call={name:"reasoning"}):(l.silent?l.pendingContent=(l.pendingContent||"")+c.data:l.content+=(l.pendingContent||"")+c.data,l.call=null),l.isProcessing=!0}await this.$nextTick();continue}if(l&&h.event=="call"){let c=JSON.parse(h.data);l=this.findMessage(c.attributes.message_id),l&&(l.call=c.data,this.isMessageVisible(l.id)&&this.generateTree(l.id));continue}if(h.event=="message"){l=JSON.parse(h.data),l.hasOwnProperty("reasoning")||(l.reasoning=""),l.content||(l.isProcessing=!0),this.addMessage(l),this.scrollToBottom();continue}if(h.event=="error"){this.error(h.data);break}}}catch(t){this.error(t)}},scrollToBottom(){this.contentElement&&this.$nextTick(()=>{this.contentElement.scrollTo({top:this.contentElement.scrollHeight,behavior:"smooth"})})},error(e){this.stopProcessing(),toast.error(e),console.error(e),this.generateTree()},async createConversation(){let t=(await f.post("/ai/conversations")).data;this.history===null&&(this.history=[]),this.history.unshift(t),this.select(t)},save(e){f.post(`/library/conversations/${e.id}`,{title:e.title}).then(t=>{if(this.history){let r=this.history.findIndex(o=>o.id===t.data.id);r>=0&&(this.history[r]=t.data)}})},enter(e){e.key==="Enter"&&!e.shiftKey&&!this.isProcessing&&this.prompt&&this.prompt.trim()!==""&&(e.preventDefault(),this.submit())},paste(e){if(!this.adapter||this.adapter.file_types.length===0)return;const t=e.clipboardData.items;for(let r=0;r<t.length;r++)if(t[r].kind==="file"){const o=t[r].getAsFile();if(o&&this.adapter.file_types.includes(o.type)){this.file=o,e.preventDefault();break}}},copy(e){navigator.clipboard.writeText(e.content).then(()=>{toast.success("Copied to clipboard!")})},textSelect(e){this.$refs.quote.classList.add("hidden"),this.$refs.quote.classList.remove("flex");let t=window.getSelection();if(t.rangeCount<=0)return;let r=t.getRangeAt(0);if(r.toString().trim()=="")return;e.stopPropagation();let l=r.startContainer,h=r.startOffset,u;if(l.nodeType===Node.TEXT_NODE){let p=document.createRange();p.setStart(l,h),p.setEnd(l,h+1),u=p.getBoundingClientRect()}else l.nodeType===Node.ELEMENT_NODE&&(u=l.getBoundingClientRect());let c=this.$refs.quote.parentElement,d=c.getBoundingClientRect(),g=u.left-d.left+c.scrollLeft,m=u.top-d.top+c.scrollTop;this.$refs.quote.style.top=m+"px",this.$refs.quote.style.left=g+"px",this.$refs.quote.classList.add("flex"),this.$refs.quote.classList.remove("hidden"),this.$refs.quote.dataset.value=r.toString()},selectQuote(){this.quote=this.$refs.quote.dataset.value,this.$refs.quote.dataset.value=null,this.$refs.quote.classList.add("hidden"),this.$refs.quote.classList.remove("flex"),window.getSelection().removeAllRanges()},regenerate(e,t=null,r=null){if(!e.parent_id)return;let o=this.conversation.messages.find(h=>h.id===e.parent_id);if(!o)return;let l=new FormData;l.append("parent_id",o.id),l.append("model",t||e.model),r?l.append("assistant_id",r.id):e.assistant&&l.append("assistant_id",e.assistant.id),this.isProcessing=!0,this.ask(l)},edit(e,t){var o;let r=new FormData;r.append("model",e.model),r.append("content",t),e.parent_id&&r.append("parent_id",e.parent_id),(o=e.assistant)!=null&&o.id&&r.append("assistant_id",e.assistant.id),e.quote&&r.append("quote",e.quote),this.isProcessing=!0,this.ask(r)},remove(e){this.isDeleting=!0,f.delete(`/library/conversations/${e.id}`).then(()=>{this.conversation=!1,window.modal.close(),toast.show("Conversation has been deleted successfully.","ti ti-trash"),this.isDeleting=!1;let t=new URL(window.location.href);t.pathname="/app/chat/",window.history.pushState({},"",t),this.history.splice(this.history.indexOf(e),1),setTimeout(()=>this.conversation=null,100)}).catch(t=>this.isDeleting=!1)},doesAssistantMatch(e,t){var r,o;return((r=this.$store.workspace.subscription)==null?void 0:r.plan.config.assistants)!=null&&!((o=this.$store.workspace.subscription)!=null&&o.plan.config.assistants.includes(e.id))?!1:(t=t.trim().toLowerCase(),!!(!t||e.name.toLowerCase().includes(t)||e.expertise&&e.expertise.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)))},selectAssistant(e){if(this.assistant=e,window.modal.close(),!this.conversation){let t=new URL(window.location.href);t.pathname="/app/chat/"+((e==null?void 0:e.id)||""),window.history.pushState({},"",t)}},toolKey(e){switch(e.object){case"image":return"imagine";default:return null}},showOptions(e=null,t="options"){this.options.assistant=e?e.assistant:this.assistant,this.options.message=e,this.options.model=e?e.model:this.adapter.model,window.modal.open(t)},applyOptions(){this.options.message?this.regenerate(this.options.message,this.options.model,this.options.assistant):(this.selectAssistant(this.options.assistant),this.adapter=this.adapters.find(e=>e.model===this.options.model)),this.options={assistant:null,model:null,message:null},window.modal.close()}}))}function Qi(){y.data("voiceIsolator",(a=null)=>({isProcessing:!1,isDeleting:!1,history:[],historyLoaded:!1,preview:a,previewTime:0,file:null,viewInputFile:!1,init(){this.$watch("preview",n=>{if(this.history&&n){let i=this.history.findIndex(s=>s.id===n.id);i>=0&&(this.history[i]=n)}}),this.fetchHistory()},fetchHistory(){let n={limit:25};this.history&&this.history.length>0&&(n.starting_after=this.history[this.history.length-1].id),f.get("/library/isolated-voices",n).then(i=>i.json()).then(i=>{let s=i.data;this.history.push(...s),s.length<n.limit&&(this.historyLoaded=!0)})},submit(n){this.isProcessing||(this.isProcessing=!0,f.post("/ai/isolated-voices",new FormData(n)).then(i=>i.json()).then(i=>{this.history===null&&(this.history=[]),this.history.push(i),this.select(i),this.isProcessing=!1,n.reset(),this.file=null}).catch(i=>this.isProcessing=!1))},save(n){f.post(`/library/isolated-voices/${n.id}`,{title:n.title})},select(n){this.preview=n;let i=new URL(window.location.href);i.pathname="/app/voice-isolator/"+n.id,window.history.pushState({},"",i)},remove(n){this.isDeleting=!0,f.delete(`/library/isolated-voices/${n.id}`).then(()=>{this.preview=null,window.modal.close(),w.show("Resource has been deleted successfully.","ti ti-trash"),this.isDeleting=!1;let i=new URL(window.location.href);i.pathname="/app/voice-isolator/",window.history.pushState({},"",i),this.history.splice(this.history.indexOf(n),1)}).catch(i=>this.isDeleting=!1)}}))}function Zi(){y.data("classifier",(a=null)=>({isProcessing:!1,isDeleting:!1,history:[],historyLoaded:!1,preview:a,prompt:null,currentResource:null,init(){this.$watch("preview",n=>{if(this.history&&n){let i=this.history.findIndex(s=>s.id===n.id);i>=0&&(this.history[i]=n)}}),this.fetchHistory()},fetchHistory(){let n={limit:25};this.history&&this.history.length>0&&(n.starting_after=this.history[this.history.length-1].id),f.get("/library/classifications",n).then(i=>i.json()).then(i=>{let s=i.data;this.history.push(...s),s.length<n.limit&&(this.historyLoaded=!0)})},submit(){if(this.isProcessing)return;this.isProcessing=!0;let n={input:this.prompt};f.post("/ai/classifications",n).then(i=>i.json()).then(i=>{this.history===null&&(this.history=[]),this.history.push(i),this.preview=i,this.isProcessing=!1,this.prompt=null,this.select(i)}).catch(i=>{this.isProcessing=!1,console.error(i)})},select(n){this.preview=n;let i=new URL(window.location.href);i.pathname="/app/classifier/"+n.id,window.history.pushState({},"",i)},save(n){f.post(`/library/classifications/${n.id}`,{title:n.title})},remove(n){this.isDeleting=!0,f.delete(`/library/classifications/${n.id}`).then(()=>{this.preview=null,window.modal.close(),toast.show("Classification has been deleted successfully.","ti ti-trash"),this.isDeleting=!1;let i=new URL(window.location.href);i.pathname="/app/classifier/",window.history.pushState({},"",i),this.history.splice(this.history.indexOf(n),1)}).catch(i=>this.isDeleting=!1)}}))}function es(){y.data("affiliates",()=>({payouts:[],payoutsFetched:!1,affiliate:{},affiliateIsProcessing:!1,withdrawIsProcessing:!1,init(){this.affiliate=this.$store.user.affiliate,this.getPayouts()},setPayoutMethod(){this.affiliateIsProcessing=!0,f.put("/account/affiliate",this.affiliate).then(a=>a.json()).then(a=>{this.affiliateIsProcessing=!1,this.$store.user=a,window.modal.close(),w.success("Changes saved successfully!")})},sendWithdrawalRequest(){this.withdrawIsProcessing=!0,f.post("/account/affiliate/payouts").then(a=>a.json()).then(a=>{w.defer("Withdrawal request sent successfully!"),window.location.reload()})},getPayouts(){let a={limit:5,sort:"created_at:desc"};f.get("/account/affiliate/payouts",a).then(n=>n.json()).then(n=>{this.payoutsFetched=!0,this.payouts=n.data})}}))}function ts(){y.data("composer",(a,n=[],i=null)=>({adapters:[],adapter:null,showSettings:!1,history:[],historyLoaded:!1,isProcessing:!1,isDeleting:!1,preview:null,prompt:null,tags:null,instrumental:!1,model:null,init(){this.$watch("adapter",()=>{var s;return this.model=(s=this.adapter)==null?void 0:s.model}),this.$watch("preview",s=>{if(this.history&&s){let e=this.history.findIndex(t=>t.id===s.id);e>=0&&(this.history[e]=s)}}),n.forEach(s=>{s.is_available&&s.models.forEach(e=>{e.is_available&&this.adapters.push(e)})}),this.adapter=this.adapters.find(s=>s.model==a),!this.adapter&&this.adapters.length>0&&(this.adapter=this.adapters[0]),i&&this.select(i),this.$watch("model",()=>this.adapter=this.adapters.find(s=>s.model==this.model)),this.fetchHistory()},fetchHistory(){let s={limit:25};this.history&&this.history.length>0&&(s.starting_after=this.history[this.history.length-1].id),f.get("/library/compositions",s).then(e=>e.json()).then(e=>{let t=e.data;this.history.push(...t),t.length<s.limit&&(this.historyLoaded=!0)})},submit(s){if(this.isProcessing)return;this.isProcessing=!0;let e={prompt:this.prompt,tags:this.tags,instrumental:this.instrumental,model:this.adapter.model||null};f.post("/ai/compositions",e).then(t=>t.json()).then(t=>{t.forEach(r=>{this.history.push(r)}),this.select(t[0]),this.prompt=null,this.isProcessing=!1}).catch(t=>{this.isProcessing=!1,this.preview=null;let r=new URL(window.location.href);r.pathname="/app/composer/",window.history.pushState({},"",r),this.history.splice(this.history.indexOf(i),1)})},select(s){this.preview=s;let e=new URL(window.location.href);e.pathname="/app/composer/"+s.id,window.history.pushState({},"",e)},remove(s){this.isDeleting=!0,f.delete(`/library/compositions/${s.id}`).then(()=>{this.preview=null,window.modal.close(),w.show("Composition has been deleted successfully.","ti ti-trash"),this.isDeleting=!1;let e=new URL(window.location.href);e.pathname="/app/composer/",window.history.pushState({},"",e),this.history.splice(this.history.indexOf(s),1)}).catch(e=>this.isDeleting=!1)}}))}function is(){y.data("video",(a,n=[],i=null)=>({services:n,model:null,history:[],historyLoaded:!1,isProcessing:!1,isDeleting:!1,preview:null,prompt:null,negativePrompt:null,frames:[],params:{},original:{},timer:0,form:!0,init(){this.$watch("preview",s=>{if(this.history&&s){let e=this.history.findIndex(t=>t.id===s.id);e>=0&&(this.history[e]=s)}}),this.selectModel(a),this.$watch("model",()=>this.reset()),i&&this.select(i),this.fetchHistory()},selectModel(s){let e=!1;this.services.forEach(t=>{t.models.forEach(r=>{r.key==s&&(this.model={...r,service:t},e=!0)})}),!e&&this.services.length>0&&this.services[0].models.length>0&&(this.model={...this.services[0].models[0],service:this.services[0]},e=!0),e||(this.model=null)},fetchHistory(){let s={limit:25};this.history&&this.history.length>0&&(s.starting_after=this.history[this.history.length-1].id),f.get("/library/videos",s).then(e=>e.json()).then(e=>{let t=e.data;this.history.push(...t),t.length<s.limit&&(this.historyLoaded=!0)})},reset(){for(let s in this.params){if(this.original[s]===void 0){delete this.params[s];continue}this.params[s]=this.original[s]}this.frames=[]},submit(s){if(this.isProcessing)return;this.isProcessing=!0,this.$nextTick(()=>this.preview=null);let e={...this.params,prompt:this.prompt,negative_prompt:this.negativePrompt,model:this.model.key||null},t=new FormData;for(let r in e)t.append(r,e[r]);for(let r of this.frames)t.append("frames[]",r);f.post("/ai/videos",t).then(r=>r.json()).then(r=>{this.history.unshift(r),this.select(r),setTimeout(()=>{this.prompt=null,this.isProcessing=!1},1e3)}).catch(r=>{this.isProcessing=!1,this.preview=null;let o=new URL(window.location.href);o.pathname="/app/video/",window.history.pushState({},"",o)})},select(s){this.preview=s,this.form=!1;let e=new URL(window.location.href);e.pathname="/app/video/"+s.id,window.history.pushState({},"",e),this.checkProgress()},remove(s){this.isDeleting=!0,f.delete(`/library/videos/${s.id}`).then(()=>{this.preview=null,this.form=!0,window.modal.close(),w.show("Video has been deleted successfully.","ti ti-trash"),this.isDeleting=!1;let e=new URL(window.location.href);e.pathname="/app/video/",window.history.pushState({},"",e),this.history.splice(this.history.indexOf(s),1)}).catch(e=>this.isDeleting=!1)},checkProgress(){this.preview.state>=3||f.get(`/library/videos/${this.preview.id}`).then(s=>s.json()).then(s=>{this.preview=s,setTimeout(()=>this.checkProgress(),5e3)})},save(s){f.post(`/library/videos/${s.id}`,{title:s.title}).then(e=>{if(this.history){let t=this.history.findIndex(r=>r.id===e.data.id);t>=0&&(this.history[t]=e.data)}})},addFrame(s){const e=Array.from(s.target.files),t=this.model.config.frames.limit||1;this.frames=[...this.frames,...e.slice(0,t-this.frames.length)],s.target.value=null,window.modal.open("options")},removeFrame(s){this.frames=this.frames.filter(e=>e!==s)},actionNew(){this.prompt=null,this.negativePrompt=null,this.params={},this.frames=[],this.form=!0;let s=new URL(window.location.href);s.pathname="/app/video/",window.history.pushState({},"",s),this.$nextTick(()=>{this.$refs.prompt.focus()})},actionEdit(){var r,o;this.prompt=((r=this.preview.params)==null?void 0:r.prompt)||null,this.negativePrompt=((o=this.preview.params)==null?void 0:o.negative_prompt)||null,this.frames=[];let s=(this.preview.params.frames||[]).map((l,h)=>new Promise(u=>{this.fileFromUrl(l,l,c=>{u({file:c,index:h})})}));Promise.all(s).then(l=>{this.frames=l.sort((h,u)=>h.index-u.index).map(h=>h.file)});let e={...this.preview.params};delete e.prompt,delete e.negative_prompt,delete e.frames,this.selectModel(this.preview.model),this.form=!0,this.$nextTick(()=>{this.params=e});let t=new URL(window.location.href);t.pathname="/app/video/",window.history.pushState({},"",t),this.$nextTick(()=>{this.$refs.prompt.focus()})},fileFromUrl(s,e,t){fetch(s).then(r=>r.blob()).then(r=>new File([r],e,{type:r.type})).then(t)}}))}Wt();ji();Kt();Yi();Gi();Ui();Xi();Yt();Fi();Bi();Ni();qi();Ji();Qi();Zi();es();ts();is();y.plugin(Ut.defaultProps({arrow:!1}));y.start();
